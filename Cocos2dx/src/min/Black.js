"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol?"symbol":typeof obj};var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var black={};(function(){var sys={};flower.addStartBack(function(){for(var key in flower.sys){sys[key]=flower.sys[key]}});var UIComponent=function(){function UIComponent(){_classCallCheck(this,UIComponent)}_createClass(UIComponent,null,[{key:"register",value:function register(clazz){var isContainer=arguments.length<=1||arguments[1]===undefined?false:arguments[1];var p=clazz.prototype;p.$initUIComponent=function(){this.$UIComponent={0:null,1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:{},11:new StringValue,12:false,13:this,14:null,15:isContainer};UIComponent.registerEvent(clazz,1e3,"creationComplete",flower.Event.CREATION_COMPLETE);UIComponent.registerEvent(clazz,1001,"add",flower.Event.ADDED);UIComponent.registerEvent(clazz,1002,"addToStage",flower.Event.ADDED_TO_STAGE);UIComponent.registerEvent(clazz,1003,"remove",flower.Event.REMOVED);UIComponent.registerEvent(clazz,1004,"removeFromStage",flower.Event.REMOVED_FROM_STAGE);UIComponent.registerEvent(clazz,1020,"touchBegin",flower.TouchEvent.TOUCH_BEGIN);UIComponent.registerEvent(clazz,1021,"touchEnd",flower.TouchEvent.TOUCH_END);UIComponent.registerEvent(clazz,1022,"touchRelease",flower.TouchEvent.TOUCH_RELEASE);UIComponent.registerEvent(clazz,1023,"rightClick",flower.MouseEvent.RIGHT_CLICK)};if(isContainer){Object.defineProperty(p,"layout",{get:function get(){return this.$UIComponent[14]},set:function set(val){if(this.$UIComponent[14]==val){return}if(this.$UIComponent[14]){this.$UIComponent[14].$clear()}this.$UIComponent[14]=val;if(val){val.$setFlag();var len=this.numChildren;for(var i=0;i<len;i++){val.addElementAt(this.getChildAt(i),i)}}this.$addFlags(8192)},enumerable:true,configurable:true});p.addChildAt=function(child,index){var flag=child.parent!=this?true:false;$root._get(Object.getPrototypeOf(p),"addChildAt",this).call(this,child,index);if(flag&&child.parent==this){if(child.__UIComponent&&!child.absoluteState){child["currentState"]=this.currentState}}if(child.parent==this&&this.layout){this.layout.addElementAt(child,index)}};p.$removeChild=function(child){$root._get(Object.getPrototypeOf(p),"$removeChild",this).call(this,child);if(child.parent!=this&&this.layout){this.layout.removeElement(child)}};p.removeChild=function(child){$root._get(Object.getPrototypeOf(p),"removeChild",this).call(this,child);if(child.parent!=this&&this.layout){this.layout.removeElement(child)}};p.setChildIndex=function(child,index){$root._get(Object.getPrototypeOf(p),"setChildIndex",this).call(this,child,index);if(child.parent==this&&this.layout){this.layout.setElementIndex(child,index)}}}p.bindProperty=function(property,content){var checks=arguments.length<=2||arguments[2]===undefined?null:arguments[2];var binds=this.$UIComponent[10];if(binds[property]){binds[property].dispose()}binds[property]=new flower.Binding(this,checks,property,content)};p.removeBindProperty=function(property){var binds=this.$UIComponent[10];if(binds[property]){binds[property].dispose();delete binds[property]}};p.removeAllBindProperty=function(){var binds=this.$UIComponent[10];for(var key in binds){binds[key].dispose();delete binds[key]}};p.setStatePropertyValue=function(property,state,val){var checks=arguments.length<=3||arguments[3]===undefined?null:arguments[3];if(!this._propertyValues){this._propertyValues={};if(!this._propertyValues[property]){this._propertyValues[property]={}}this.bindProperty("currentState","{this.changeState(this.state)}");this._propertyValues[property][state]={value:val,checks:checks}}else{if(!this._propertyValues[property]){this._propertyValues[property]={}}this._propertyValues[property][state]={value:val,checks:checks}}if(state==this.currentState){this.removeBindProperty(property);this.bindProperty(property,val)}};p.changeState=function(state){if(!this._propertyValues){return this.currentState}for(var property in this._propertyValues){if(this._propertyValues[property][state]){this.removeBindProperty(property);this.bindProperty(property,this._propertyValues[property][state].value,this._propertyValues[property][state].checks)}}return this.currentState};p.$callUIComponentEvent=function(type,args){var func=this.$UIComponent[type];if(func){func.apply(this.eventThis,args)}};p.$setLeft=function(val){var p=this.$UIComponent;if(val==null){if(p[0]==null){return}}else{val=+val||0;if(p[0]==val){return false}}p[0]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$setRight=function(val){var p=this.$UIComponent;if(val==null){if(p[1]==null){return}}else{val=+val||0;if(p[1]==val){return false}}p[1]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$setHorizontalCenter=function(val){val=+val||0;var p=this.$UIComponent;if(p[2]==val){return false}p[2]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$setTop=function(val){val=+val||0;var p=this.$UIComponent;if(p[3]==val){return false}p[3]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$setBottom=function(val){val=+val||0;var p=this.$UIComponent;if(p[4]==val){return false}p[4]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$setVerticalCenter=function(val){val=+val||0;var p=this.$UIComponent;if(p[5]==val){return false}p[5]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$setPercentWidth=function(val){val=+val||0;var p=this.$UIComponent;if(p[6]==val){return false}p[6]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$setPercentHeight=function(val){val=+val||0;var p=this.$UIComponent;if(p[7]==val){return false}p[7]=val;if(!isContainer){p[15]=p[0]!=null||p[1]!=null||p[2]!=null||p[3]!=null||p[4]!=null||p[5]!=null||p[6]!=null||p[7]!=null?true:false}this.$invalidateContentBounds()};p.$getBounds=function(){var fromParent=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var rect=$root._get(Object.getPrototypeOf(p),"$getBounds",this).call(this,fromParent);if(fromParent){var ui=this.$UIComponent;if((ui[0]==null||ui[1]==null)&&ui[6]!=null||ui[0]!=null&&ui[1]!=null){rect.width=0}if((ui[3]==null||ui[4]==null)&&ui[7]!=null||ui[3]!=null&&ui[4]!=null){rect.height=0}}return rect};Object.defineProperty(p,"left",{get:function get(){return this.$UIComponent[0]},set:function set(val){this.$setLeft(val)},enumerable:true,configurable:true});Object.defineProperty(p,"right",{get:function get(){return this.$UIComponent[1]},set:function set(val){this.$setRight(val)},enumerable:true,configurable:true});Object.defineProperty(p,"horizontalCenter",{get:function get(){return this.$UIComponent[2]},set:function set(val){this.$setHorizontalCenter(val)},enumerable:true,configurable:true});Object.defineProperty(p,"top",{get:function get(){return this.$UIComponent[3]},set:function set(val){this.$setTop(val)},enumerable:true,configurable:true});Object.defineProperty(p,"bottom",{get:function get(){return this.$UIComponent[4]},set:function set(val){this.$setBottom(val)},enumerable:true,configurable:true});Object.defineProperty(p,"verticalCenter",{get:function get(){return this.$UIComponent[5]},set:function set(val){this.$setVerticalCenter(val)},enumerable:true,configurable:true});Object.defineProperty(p,"percentWidth",{get:function get(){return this.$UIComponent[6]},set:function set(val){this.$setPercentWidth(val)},enumerable:true,configurable:true});Object.defineProperty(p,"percentHeight",{get:function get(){return this.$UIComponent[7]},set:function set(val){this.$setPercentHeight(val)},enumerable:true,configurable:true});Object.defineProperty(p,"currentState",{get:function get(){return this.state.value},set:function set(val){if(this instanceof flower.Sprite){if(this.state.value==val){return}this.state.value=val;for(var i=0;i<this.numChildren;i++){var child=this.getChildAt(i);if(child.__UIComponent){if(!child.absoluteState){child.currentState=val}}}}else{if(this.state.value==val){return}this.state.value=val}},enumerable:true,configurable:true});Object.defineProperty(p,"state",{get:function get(){return this.$UIComponent[11]},set:function set(val){},enumerable:true,configurable:true});Object.defineProperty(p,"absoluteState",{get:function get(){return this.$UIComponent[12]},set:function set(val){if(val=="false"){val=false}this.$UIComponent[12]=!!val},enumerable:true,configurable:true});Object.defineProperty(p,"eventThis",{get:function get(){return this.$UIComponent[13]},set:function set(val){this.$UIComponent[13]=val||this},enumerable:true,configurable:true})}}]);return UIComponent}();UIComponent.registerEvent=function(clazz,index,name,eventType){var p=clazz.prototype;Object.defineProperty(p,name,{get:function get(){return this.$UIComponent[index]},set:function set(val){if(typeof val=="string"){var content=val;val=function val(){eval(content)}}this.$UIComponent[index]=val;if(val){if(!this.$UIComponent[1e3+index]){this.$UIComponent[1e3+index]=function(){var args=[];for(var i=0;i<arguments.length;i++){args[i]=arguments[i]}this.$callUIComponentEvent(index,args)};this.addListener(eventType,this.$UIComponent[1e3+index],this)}}},enumerable:true,configurable:true})};black.UIComponent=UIComponent;var Value=function(_flower$EventDispatch){_inherits(Value,_flower$EventDispatch);function Value(){var checkDistort=arguments.length<=0||arguments[0]===undefined?null:arguments[0];_classCallCheck(this,Value);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Value).call(this));_this.__old=null;_this.__value=null;_this.__checkDistort=null;_this.__list=null;_this.__check=true;_this.__checkDistort=checkDistort==null?Value.Default_Check_Distort:checkDistort;return _this}_createClass(Value,[{key:"$setValue",value:function $setValue(val){if(val==this.__value){return}this.__old=this.__value;this.__value=val}},{key:"$getValue",value:function $getValue(){return this.__value}},{key:"push",value:function push(val){if(!this.__list){this.__list=[]}this.__list.push(val)}},{key:"pop",value:function pop(){if(this.__list){return this.__list.pop()}return null}},{key:"value",get:function get(){if(this.__checkDistort){return this.$getValue()}return this.__value},set:function set(val){this.$setValue(val)}},{key:"old",get:function get(){return this.__old}},{key:"check",get:function get(){return this.__check},set:function set(val){this.__check=!!val}}]);return Value}(flower.EventDispatcher);Value.Default_Check_Distort=false;black.Value=Value;var ArrayValue=function(_Value){_inherits(ArrayValue,_Value);function ArrayValue(){var init=arguments.length<=0||arguments[0]===undefined?null:arguments[0];var itemType=arguments.length<=1||arguments[1]===undefined?"*":arguments[1];_classCallCheck(this,ArrayValue);var _this2=_possibleConstructorReturn(this,Object.getPrototypeOf(ArrayValue).call(this));_this2._key="";_this2._rangeMinKey="";_this2._rangeMaxKey="";_this2._selectedItem=null;_this2._itemType=null;_this2._subs=null;_this2.$sub=false;_this2._itemType=itemType;_this2.list=init||[];_this2._length=_this2.list.length;_this2.__value=_this2;_this2._lengthValue=new flower.IntValue;return _this2}_createClass(ArrayValue,[{key:"push",value:function push(item){this.list.push(item);this._length=this._length+1;this._lengthValue.value=this._length;if(this._subs){this.__checkSubPush(item);this.__addItemChange(item)}this.dispatchWith(flower.Event.ADD,item);this.dispatchWith(flower.Event.CHANGE,this)}},{key:"addItemAt",value:function addItemAt(item,index){index=+index&~0;if(index<0||index>this.list.length){sys.$error(3101,index,this.list.length);return}this.list.splice(index,0,item);this._length=this._length+1;this._lengthValue.value=this._length;if(this._subs){this.__checkSubAddItemAt(item,index);this.__addItemChange(item)}this.dispatchWith(flower.Event.ADD,item);this.dispatchWith(flower.Event.CHANGE,this)}},{key:"shift",value:function shift(){if(!this.list.length){return}var item=this.list.shift();this._length=this._length-1;this._lengthValue.value=this._length;if(this._subs){this.__checkSubRemoveItem(item);this.__removeItemChange(item)}this.dispatchWith(flower.Event.REMOVE,item);this.dispatchWith(flower.Event.CHANGE,this);return item}},{key:"splice",value:function splice(startIndex){var delCount=arguments.length<=1||arguments[1]===undefined?0:arguments[1];var i;startIndex=+startIndex&~0;delCount=+delCount&~0;var list;if(delCount<=0){list=[];for(var _len=arguments.length,args=Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){args[_key-2]=arguments[_key]}for(i=0;i<args.length;i++){list[i]=args[i];this.list.splice(startIndex,0,args[i])}this._length=this._length+1;this._lengthValue.value=this._length;for(i=0;i<args.length;i++){if(this._subs){this.__checkSubAddItemAt(args[i],startIndex+i);this.__addItemChange(args[i])}this.dispatchWith(flower.Event.ADD,args[i])}this.dispatchWith(flower.Event.CHANGE,this)}else{list=this.list.splice(startIndex,delCount);this._length=this._length-delCount;this._lengthValue.value=this._length;for(i=0;i<list.length;i++){if(this._subs){this.__checkSubRemoveItem(list[i]);this.__removeItemChange(list[i])}this.dispatchWith(flower.Event.REMOVE,list[i])}this.dispatchWith(flower.Event.CHANGE,this)}return list}},{key:"slice",value:function slice(startIndex,end){startIndex=+startIndex&~0;end=+end&~0;return new ArrayValue(this.list.slice(startIndex,end))}},{key:"pop",value:function pop(){if(!this.list.length){return}var item=this.list.pop();this._length=this._length-1;this._lengthValue.value=this._length;if(this._subs){this.__checkSubRemoveItem(item);this.__removeItemChange(item)}this.dispatchWith(flower.Event.REMOVE,item);this.dispatchWith(flower.Event.CHANGE,this);return item}},{key:"removeAll",value:function removeAll(){if(!this.list.length){return}if(this._subs){this.__subRemoveAll()}while(this.list.length){var item=this.list.pop();this._length=this._length-1;this._lengthValue.value=this._length;if(this._subs){this.__removeItemChange(item)}this.dispatchWith(flower.Event.REMOVE,item)}this.dispatchWith(flower.Event.CHANGE,this)}},{key:"removeItem",value:function removeItem(item){for(var i=0,len=this.list.length;i<len;i++){if(this.list[i]==item){this.list.splice(i,1);this._length=this._length-1;this._lengthValue.value=this._length;if(this._subs){this.__checkSubRemoveItem(item);this.__removeItemChange(item)}this.dispatchWith(flower.Event.REMOVE,item);this.dispatchWith(flower.Event.CHANGE,this);return item}}return null}},{key:"removeItemAt",value:function removeItemAt(index){index=+index&~0;if(index<0||index>=this.list.length){sys.$error(3101,index,this.list.length);return}var item=this.list.splice(index,1)[0];this._length=this._length-1;this._lengthValue.value=this._length;if(this._subs){this.__checkSubRemoveItem(item);this.__removeItemChange(item)}this.dispatchWith(flower.Event.REMOVE,item);this.dispatchWith(flower.Event.CHANGE,this);return item}},{key:"removeItemWith",value:function removeItemWith(key,value){var key2=arguments.length<=2||arguments[2]===undefined?"":arguments[2];var value2=arguments.length<=3||arguments[3]===undefined?null:arguments[3];var item;var i;if(key2==""){for(i=0;i<this.list.length;i++){var val=this.list[i][key];if(val instanceof Value&&!(val instanceof flower.ObjectValue)&&!(val instanceof flower.ArrayValue)){val=val.value}if(val==value){item=this.list.splice(i,1)[0];break}}}else{for(i=0;i<this.list.length;i++){var val1=this.list[i][key];if(val1 instanceof Value&&!(val1 instanceof flower.ObjectValue)&&!(val1 instanceof flower.ArrayValue)){val1=val1.value}var val2=this.list[i][key2];if(val2 instanceof Value&&!(val2 instanceof flower.ObjectValue)&&!(val2 instanceof flower.ArrayValue)){val2=val2.value}if(val==value&&val2==value2){item=this.list.splice(i,1)[0];break}}}if(!item){return}this._length=this._length-1;this._lengthValue.value=this._length;if(this._subs){this.__checkSubRemoveItem(item);this.__removeItemChange(item)}this.dispatchWith(flower.Event.REMOVE,item);this.dispatchWith(flower.Event.CHANGE,this);return item}},{key:"getItemIndex",value:function getItemIndex(item){for(var i=0,len=this.list.length;i<len;i++){if(this.list[i]==item||!(item instanceof flower.Value)&&this.list[i]instanceof Value&&this.list[i].value==item){return i}}return-1}},{key:"getItemWith",value:function getItemWith(key,value){var key2=arguments.length<=2||arguments[2]===undefined?"":arguments[2];var value2=arguments.length<=3||arguments[3]===undefined?null:arguments[3];var i;if(key2==""){for(i=0;i<this.list.length;i++){var keys=key.split(".");var val1=this.list[i];for(var k=0;k<keys.length;k++){val1=val1[keys[k]]}if(val1 instanceof flower.Value&&!(val1 instanceof flower.ObjectValue)&&!(val1 instanceof flower.ArrayValue)){val1=val1.value}if(val1==value){return this.list[i]}}}else{for(i=0;i<this.list.length;i++){var keys=key.split(".");var val1=this.list[i];for(var k=0;k<keys.length;k++){val1=val1[keys[k]]}if(val1 instanceof flower.Value&&!(val1 instanceof flower.ObjectValue)&&!(val1 instanceof flower.ArrayValue)){val1=val1.value}keys=key2.split(".");var val2=this.list[i];for(var k=0;k<keys.length;k++){val2=val2[keys[k]]}if(val2 instanceof flower.Value&&!(val2 instanceof flower.ObjectValue)&&!(val2 instanceof flower.ArrayValue)){val2=val2.value}if(val1==value&&val2==value2){return this.list[i]}}}return null}},{key:"getItemFunction",value:function getItemFunction(func,thisObj){for(var _len2=arguments.length,args=Array(_len2>2?_len2-2:0),_key2=2;_key2<_len2;_key2++){args[_key2-2]=arguments[_key2]}for(var i=0;i<this.list.length;i++){args.push(this.list[i]);var r=func.apply(thisObj,args);args.pop();if(r==true){return this.list[i]}}return null}},{key:"getItemsWith",value:function getItemsWith(key,value){var key2=arguments.length<=2||arguments[2]===undefined?"":arguments[2];var value2=arguments.length<=3||arguments[3]===undefined?null:arguments[3];var result=[];var i;if(key2==""){for(i=0;i<this.list.length;i++){var keys=key.split(".");var val1=this.list[i];for(var k=0;k<keys.length;k++){val1=val1[keys[k]]}if(val1 instanceof flower.Value&&!(val1 instanceof flower.ObjectValue)&&!(val1 instanceof flower.ArrayValue)){val1=val1.value}if(val1==value){result.push(this.list[i])}}}else{for(i=0;i<this.list.length;i++){var keys=key.split(".");var val1=this.list[i];for(var k=0;k<keys.length;k++){val1=val1[keys[k]]}if(val1 instanceof flower.Value&&!(val1 instanceof flower.ObjectValue)&&!(val1 instanceof flower.ArrayValue)){val1=val1.value}keys=key2.split(".");var val2=this.list[i];for(var k=0;k<keys.length;k++){val2=val2[keys[k]]}if(val2 instanceof flower.Value&&!(val2 instanceof flower.ObjectValue)&&!(val2 instanceof flower.ArrayValue)){val2=val2.value}if(val1==value&&val2==value2){result.push(this.list[i])}}}return result}},{key:"setItemsAttributeWith",value:function setItemsAttributeWith(findKey,findValue){var setKey=arguments.length<=2||arguments[2]===undefined?"":arguments[2];var setValue=arguments.length<=3||arguments[3]===undefined?null:arguments[3];for(var i=0;i<this.list.length;i++){if(this.list[i][findKey]instanceof flower.Value&&this.list[i][findKey].value==findValue){this.list[i][setKey].value=setValue}else if(this.list[i][findKey]==findValue){this.list[i][setKey]=setValue}}}},{key:"getItemsFunction",value:function getItemsFunction(func){var thisObj=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var _arguments__=[];for(var argumentsLength=0;argumentsLength<arguments.length;argumentsLength++){_arguments__=arguments[argumentsLength]}var result=[];var args=[];if(_arguments__.length&&_arguments__.length>2){args=[];for(var a=2;a<_arguments__.length;a++){args.push(_arguments__[a])}}for(var i=0;i<this.list.length;i++){args.push(this.list[i]);var r=func.apply(thisObj,args);args.pop();if(r==true){result.push(this.list[i])}}return result}},{key:"sort",value:function sort(){this.list.sort.apply(this.list,arguments);this.dispatchWith(flower.Event.CHANGE,this)}},{key:"setItemIndex",value:function setItemIndex(item,index){var itemIndex=this.getItemIndex(item);if(itemIndex<0||itemIndex==index){return}this.list.splice(itemIndex,1);this.list.splice(index,0,item);this.dispatchWith(flower.Event.CHANGE,this)}},{key:"getItemAt",value:function getItemAt(index){index=+index&~0;if(index<0||index>=this.list.length){sys.$error(3101,index,this.list.length);return}return this.list[index]}},{key:"setItemAt",value:function setItemAt(index,item){this.splice(index,1);this.splice(index,0,item)}},{key:"getItemByValue",value:function getItemByValue(value){if(this.key==""){return null}for(var i=0;i<this.list.length;i++){if(this.list[i][this.key]instanceof Value&&this.list[i][this.key].value==value||this.list[i][this.key]==value){return this.list[i]}}return null}},{key:"getItemByRange",value:function getItemByRange(value){if(this.key==""||this.rangeMinKey==""||this.rangeMaxKey==""){return null}for(var i=0;i<this.list.length;i++){var min=this.list[i][this.rangeMinKey];var max=this.list[i][this.rangeMaxKey];if(value>=min&&value<=max){return this.list[i]}}return null}},{key:"getItemsByRange",value:function getItemsByRange(value){if(this.key==""||this.rangeMinKey==""||this.rangeMaxKey==""){return null}var list=[];for(var i=0;i<this.list.length;i++){var min=this.list[i][this.rangeMinKey];var max=this.list[i][this.rangeMaxKey];if(value>=min&&value<=max){list.push(this.list[i])}}return list}},{key:"createSubArrayValue",value:function createSubArrayValue(){for(var _len3=arguments.length,args=Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}if(!this._subs){this._subs=[]}var init=[];var list=this.list;for(var i=0;i<list.length;i++){var item=this.list[i];var flag=true;for(var a=0;a<arguments.length;a++,a++){if(item instanceof Value){if(item[arguments[a]].value!=arguments[a+1]){flag=false;break}}else if(item[arguments[a]]!=arguments[a+1]){flag=false;break}}if(flag){init.push(item)}}var sub=new ArrayValue(init,this._itemType);sub.$sub=true;this._subs.push([sub,arguments]);this.__addAllItemChange();return sub}},{key:"linkSubArrayValue",value:function linkSubArrayValue(sub){if(!this._subs){this._subs=[]}sub.$sub=true;sub.removeAll();for(var _len4=arguments.length,args=Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++){args[_key4-1]=arguments[_key4]}this._subs.push([sub,args]);var list=this.list;for(var i=0;i<list.length;i++){var item=this.list[i];var flag=true;for(var a=1;a<args.length;a++,a++){if(item instanceof Value){if(item[args[a]].value!=args[a+1]){flag=false;break}}else if(item[args[a]]!=args[a+1]){flag=false;break}}if(flag){sub.push(item)}}this.__addAllItemChange()}},{key:"__addAllItemChange",value:function __addAllItemChange(){var list=this.list;var subs=this._subs;for(var i=0;i<list.length;i++){var item=this.list[i];for(var s=0;s<subs.length;s++){var args=subs[s][1];for(var a=0;a<args.length;a++,a++){var key=args[a];if(item[key]instanceof Value){item[key].addListener(flower.Event.CHANGE,this.__onItemChange,this,0,item)}}}}}},{key:"__addItemChange",value:function __addItemChange(item){var subs=this._subs;for(var s=0;s<subs.length;s++){var args=subs[s][1];for(var a=0;a<args.length;a++,a++){var key=args[a];if(item[key]instanceof Value){item[key].addListener(flower.Event.CHANGE,this.__onItemChange,this,0,item)}}}}},{key:"__removeItemChange",value:function __removeItemChange(item){var keys=item.membersKey;for(var i=0;i<keys.length;i++){if(item[keys[i]]instanceof flower.Value){item[keys[i]].removeListener(flower.Event.CHANGE,this.__onItemChange,this)}}}},{key:"__onItemChange",value:function __onItemChange(e,item){var subs=this._subs;for(var s=0;s<subs.length;s++){var sub=subs[s][0];var args=subs[s][1];var oldIndex=sub.getItemIndex(item);var flag=true;for(var a=0;a<args.length;a++,a++){var key=args[a];var value=args[a+1];if(item[key]instanceof Value){if(item[key].value!=value){flag=false;break}}else if(item[key]!=value){flag=false;break}}if(oldIndex==-1&&flag){var index=this.getItemIndex(item);var ind=-1;for(var f=index-1;f>=0;f++){ind=sub.getItemIndex(this.list[f]);if(ind!=-1){ind++;break}}if(ind==-1){ind=0}sub.addItemAt(item,ind)}else if(oldIndex!=-1&&!flag){sub.removeItem(item)}}}},{key:"__checkSubPush",value:function __checkSubPush(item){for(var s=0;s<this._subs.length;s++){var sub=this._subs[s][0];var args=this._subs[s][1];var flag=true;for(var a=0;a<args.length;a++,a++){var key=args[a];var value=args[a+1];if(item[key]instanceof Value){if(item[key].value!=value){flag=false;break}}else if(item[key]!=value){flag=false;break}}if(flag){sub.push(item)}}}},{key:"__checkSubAddItemAt",value:function __checkSubAddItemAt(item,index){for(var s=0;s<this._subs.length;s++){var sub=this._subs[s][0];var args=this._subs[s][1];var flag=true;for(var a=0;a<args.length;a++,a++){var key=args[a];var value=args[a+1];if(item[key]instanceof Value){if(item[key].value!=value){flag=false;break}}else if(item[key]!=value){flag=false;break}}if(flag){var ind=-1;for(var f=index-1;f>=0;f++){ind=sub.getItemIndex(this.list[f]);if(ind!=-1){ind++;break}}if(ind==-1){ind=0}sub.addItemAt(item,ind)}}}},{key:"__checkSubRemoveItem",value:function __checkSubRemoveItem(item){for(var s=0;s<this._subs.length;s++){var sub=this._subs[s][0];var ind=sub.getItemIndex(item);if(ind!=-1){sub.removeItemAt(ind)}}}},{key:"__subRemoveAll",value:function __subRemoveAll(){for(var s=0;s<this._subs.length;s++){var sub=this._subs[s][0];sub.removeAll()}}},{key:"dispose",value:function dispose(){var list=this.list;for(var i=0;i<list.length;i++){var value=this.list[i];if(value instanceof Value){value.dispose()}}if(this._subs){while(this._subs){var sub=this._subs.pop()[0];sub.removeAll();sub.dispose()}this._subs=null}_get(Object.getPrototypeOf(ArrayValue.prototype),"dispose",this).call(this)}},{key:"$setValue",value:function $setValue(val){this.removeAll();var itemType=this._itemType;for(var i=0;i<val.length;i++){this.push(DataManager.createData(itemType,val[i]))}}},{key:"value",get:function get(){var res=[];var list=this.list;for(var i=0,len=list.length;i<len;i++){var item=list[i];if(item instanceof Value){res.push(item.value)}else{res.push(item)}}return res},set:function set(val){this.$setValue(val)}},{key:"key",set:function set(val){this._key=val},get:function get(){return this._key}},{key:"rangeMinKey",set:function set(val){this._rangeMinKey=val},get:function get(){return this._rangeMinKey}},{key:"rangeMaxKey",set:function set(val){this._rangeMaxKey=val},get:function get(){return this._rangeMaxKey}},{key:"length",get:function get(){return this._length},set:function set(val){val=+val&~0;if(this._length==val){}else{while(this.list.length>val){var item=this.list.pop();this._length=this._length-1;this._lengthValue.value=this._length;this.dispatchWith(flower.Event.REMOVE,item)}this.dispatchWith(flower.Event.CHANGE,this)}}},{key:"lengthIntValue",get:function get(){return this._lengthValue}}]);return ArrayValue}(Value);for(var i=0;i<1e3;i++){Object.defineProperty(ArrayValue.prototype,""+i,{get:function(index){return function(){return this.list[index]}}(i),set:function(index){return function(val){this.setItemAt(index,val)}}(i),enumerable:true,configurable:true})}black.ArrayValue=ArrayValue;var BooleanValue=function(_Value2){_inherits(BooleanValue,_Value2);function BooleanValue(){var init=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var enumList=arguments.length<=1||arguments[1]===undefined?null:arguments[1];_classCallCheck(this,BooleanValue);var _this3=_possibleConstructorReturn(this,Object.getPrototypeOf(BooleanValue).call(this));if(init=="false"){init=false}_this3.__enumList=enumList;_this3.__old=_this3.__value=!!init;return _this3}_createClass(BooleanValue,[{key:"$setValue",value:function $setValue(val){if(val=="false"){val=false}val=!!val;if(this.__check&&val==this.__value){return}this.__old=this.__value;this.__value=val;this.dispatchWith(flower.Event.CHANGE,this,val)}},{key:"$setEnumList",value:function $setEnumList(val){if(this.__enumList==val){return}this.__enumList=val}},{key:"enumList",get:function get(){return this.__enumList},set:function set(val){this.$setEnumList(val)}}]);return BooleanValue}(Value);black.BooleanValue=BooleanValue;var IntValue=function(_Value3){_inherits(IntValue,_Value3);function IntValue(){var init=arguments.length<=0||arguments[0]===undefined?0:arguments[0];var enumList=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var checkDistort=arguments.length<=2||arguments[2]===undefined?null:arguments[2];_classCallCheck(this,IntValue);var _this4=_possibleConstructorReturn(this,Object.getPrototypeOf(IntValue).call(this,checkDistort));_this4.__old=_this4.__value=+init&~0||0;_this4.__enumList=enumList;_this4.__valueCheck=[48];return _this4}_createClass(IntValue,[{key:"$setValue",value:function $setValue(val){val=+val&~0||0;if(this.__check&&val==this.__value){return}this.__old=this.__value;this.__value=val;if(this.__checkDistort){var str=val+"";this.__valueCheck.length=0;for(var i=0;i<str.length;i++){this.__valueCheck.push(str.charCodeAt(i))}}this.dispatchWith(flower.Event.CHANGE,this,val)}},{key:"$getValue",value:function $getValue(){if(this.__checkDistort){flower.breakPoint();var str=this.__value+"";var compare="";for(var i=0;i<this.__valueCheck.length;i++){compare+=String.fromCharCode(this.__valueCheck[i])}if(str!=compare){this.dispatchWith(flower.Event.DISTORT,this);this.__value=parseFloat(compare)}}return this.__value}},{key:"$setEnumList",value:function $setEnumList(val){if(this.__enumList==val){return}this.__enumList=val}},{key:"enumList",get:function get(){return this.__enumList},set:function set(val){this.$setEnumList(val)}}]);
return IntValue}(Value);black.IntValue=IntValue;var NumberValue=function(_Value4){_inherits(NumberValue,_Value4);function NumberValue(){var init=arguments.length<=0||arguments[0]===undefined?0:arguments[0];var enumList=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var checkDistort=arguments.length<=2||arguments[2]===undefined?null:arguments[2];_classCallCheck(this,NumberValue);var _this5=_possibleConstructorReturn(this,Object.getPrototypeOf(NumberValue).call(this,checkDistort));_this5.__enumList=enumList;_this5.__old=_this5.__value=+init||0;_this5.__precision=2;_this5.__multiplier=Math.pow(10,_this5.__precision);_this5.__valueCheck=[48];return _this5}_createClass(NumberValue,[{key:"$setValue",value:function $setValue(val){val=+val||0;if(val>0){var smallNumber=val-Math.floor(val);smallNumber=Math.floor(smallNumber*this.__multiplier)/this.__multiplier;val=Math.floor(val)+smallNumber}else{val=-val;var smallNumber=val-Math.floor(val);smallNumber=Math.floor(smallNumber*this.__multiplier)/this.__multiplier;val=Math.floor(val)+smallNumber;val=-val}if(this.__check&&val==this.__value){return}this.__old=this.__value;this.__value=val;if(this.__checkDistort){var str=val+"";this.__valueCheck.length=0;for(var i=0;i<str.length;i++){this.__valueCheck.push(str.charCodeAt(i))}}this.dispatchWith(flower.Event.CHANGE,this,val)}},{key:"$getValue",value:function $getValue(){if(this.__checkDistort){var str=this.__value+"";var compare="";for(var i=0;i<this.__valueCheck.length;i++){compare+=String.fromCharCode(this.__valueCheck[i])}if(str!=compare){this.dispatchWith(flower.Event.DISTORT,this);this.__value=parseFloat(compare)}}return this.__value}},{key:"$setEnumList",value:function $setEnumList(val){if(this.__enumList==val){return}this.__enumList=val}},{key:"enumList",get:function get(){return this.__enumList},set:function set(val){this.$setEnumList(val)}},{key:"precision",set:function set(val){this.__precision=val;this.__multiplier=Math.pow(10,this.__precision);this.$setValue(this.__value)},get:function get(){return this.__precision}}]);return NumberValue}(Value);black.NumberValue=NumberValue;var ObjectValue=function(_Value5){_inherits(ObjectValue,_Value5);function ObjectValue(){var init=arguments.length<=0||arguments[0]===undefined?null:arguments[0];_classCallCheck(this,ObjectValue);var _this6=_possibleConstructorReturn(this,Object.getPrototypeOf(ObjectValue).call(this));_this6.__old=_this6.__value={};if(init){_this6.value=init}_this6.__saveClass={};_this6.__nosave={};return _this6}_createClass(ObjectValue,[{key:"$setMember",value:function $setMember(name,value){var old=this.__value[name];this.__value[name]=value;this.dispatchWith(name,{name:name,old:old,value:value})}},{key:"$setMemberSaveClass",value:function $setMemberSaveClass(name){var saveClass=arguments.length<=1||arguments[1]===undefined?false:arguments[1];this.__saveClass[name]=saveClass}},{key:"$setMemberSaveFlag",value:function $setMemberSaveFlag(name){var save=arguments.length<=1||arguments[1]===undefined?false:arguments[1];if(save==false){this.__nosave[name]=true}else{delete this.__nosave[name]}}},{key:"hasMember",value:function hasMember(name){return this.__value.hasOwnProperty(name)}},{key:"getValue",value:function getValue(name){return this.__value[name]}},{key:"setValue",value:function setValue(name,value){if(!this.__value.hasOwnProperty(name)){sys.$error(3014,name);return}if(value==null){this.$setMember(name,null)}else{if(value&&!(value instanceof Value)&&(typeof value==="undefined"?"undefined":_typeof(value))=="object"&&value.__className){value=flower.DataManager.createData(value.__className,value)}if(value instanceof Value){this.$setMember(name,value)}else{var val=this.__value[name];var old=val;if(val instanceof Value){val.value=value}else{this.__value[name]=value;this.dispatchWith(name,{name:name,old:old,value:value})}}}}},{key:"$setValue",value:function $setValue(val){if(val==null){sys.$error(3015);return}var list=Object.keys(val);for(var i=0;i<list.length;i++){var key=list[i];var value=val[key];if(!this.__value.hasOwnProperty(key)){this.$setMember(key,value)}else{this.setValue(key,value)}}}},{key:"$getValue",value:function $getValue(){var saveClass=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var val=this.__value;var list=Object.keys(val);var config={};for(var i=0;i<list.length;i++){var key=list[i];if(this.__nosave[key]){continue}var member=val[key];if(member instanceof Value){if(member instanceof ObjectValue){config[key]=member.$getValue(this.__saveClass[key])}else{config[key]=member.value}}else{config[key]=member}}if(this.__className&&saveClass){config.__className=this.__className.value}return config}},{key:"dispose",value:function dispose(){var val=this.__value;var list=Object.keys(val);for(var i=0;i<list.length;i++){var key=list[i];if(val[key]instanceof Value){val[key].dispose()}}_get(Object.getPrototypeOf(ObjectValue.prototype),"dispose",this).call(this)}},{key:"value",get:function get(){return this.$getValue()},set:function set(val){this.$setValue(val)}},{key:"className",get:function get(){return this.__className?this.__className.value:""},set:function set(val){if(val){this.__className=new StringValue(val)}else{this.__className=null}}},{key:"membersKey",get:function get(){return Object.keys(this.__value)}}]);return ObjectValue}(Value);black.ObjectValue=ObjectValue;var StringValue=function(_Value6){_inherits(StringValue,_Value6);function StringValue(){var init=arguments.length<=0||arguments[0]===undefined?"":arguments[0];var enumList=arguments.length<=1||arguments[1]===undefined?null:arguments[1];_classCallCheck(this,StringValue);var _this7=_possibleConstructorReturn(this,Object.getPrototypeOf(StringValue).call(this));_this7.__old=_this7.__value=""+(init==null?"":init);_this7.__enumList=enumList;return _this7}_createClass(StringValue,[{key:"$setValue",value:function $setValue(val){val=""+(val==null?"":val);if(this.__check&&val==this.__value){return}this.__old=this.__value;this.__value=val;this.dispatchWith(flower.Event.CHANGE,this,val)}},{key:"$setEnumList",value:function $setEnumList(val){if(this.__enumList==val){return}this.__enumList=val}},{key:"enumList",get:function get(){return this.__enumList},set:function set(val){this.$setEnumList(val)}}]);return StringValue}(Value);black.StringValue=StringValue;var UIntValue=function(_Value7){_inherits(UIntValue,_Value7);function UIntValue(){var init=arguments.length<=0||arguments[0]===undefined?0:arguments[0];var enumList=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var checkDistort=arguments.length<=2||arguments[2]===undefined?null:arguments[2];_classCallCheck(this,UIntValue);var _this8=_possibleConstructorReturn(this,Object.getPrototypeOf(UIntValue).call(this,checkDistort));init=+init&~0||0;if(init<0){init=0}_this8.__enumList=enumList;_this8.__old=_this8.__value=init;_this8.__valueCheck=[48];return _this8}_createClass(UIntValue,[{key:"$setValue",value:function $setValue(val){val=+val&~0||0;if(val<0){val=0}if(this.__check&&val==this.__value){return}this.__old=this.__value;this.__value=val;if(this.__checkDistort){var str=val+"";this.__valueCheck.length=0;for(var i=0;i<str.length;i++){this.__valueCheck.push(str.charCodeAt(i))}}this.dispatchWith(flower.Event.CHANGE,this,val)}},{key:"$getValue",value:function $getValue(){if(this.__checkDistort){var str=this.__value+"";var compare="";for(var i=0;i<this.__valueCheck.length;i++){compare+=String.fromCharCode(this.__valueCheck[i])}if(str!=compare){this.dispatchWith(flower.Event.DISTORT,this);this.__value=parseFloat(compare)}}return this.__value}},{key:"$setEnumList",value:function $setEnumList(val){if(this.__enumList==val){return}this.__enumList=val}},{key:"enumList",get:function get(){return this.__enumList},set:function set(val){this.$setEnumList(val)}}]);return UIntValue}(Value);black.UIntValue=UIntValue;var locale_strings=flower.sys.$locale_strings["zh_CN"];locale_strings[3001]="UIParse 异步加载资源出错 : {0}";locale_strings[3002]="找不到 UI 对应的路径， UI 类名: {0}";locale_strings[3003]="解析 UI 出错,:\n{0}\n{1}\n\n解析后内容为:\n{2}";locale_strings[3004]="解析 UI 出错:无法解析的命名空间 {0} :\n{1}";locale_strings[3005]="解析 UI 出错:无法解析的类名 {0} :\n{1}";locale_strings[3006]='解析 UI 出错,未设置命名空间 xmlns:f="flower" :\n{0}';locale_strings[3007]="解析 UI 脚本文件出错, url={0} content:\n{1}";locale_strings[3008]="语法分析错误，源代码:\n{0}\n错误信息 :{1}";locale_strings[3010]="没有定义数据结构类名 :\n{0}";locale_strings[3011]="数据结构类定义解析出错 : {0}\n{1}";locale_strings[3012]="没有定义的数据结构 : {0}";locale_strings[3013]="没有找到要集成的数据结构类 :{0} ，数据结构定义为:\n{1}";locale_strings[3014]="无法设置属性值，该对象没有此属性 : {0}";locale_strings[3015]="对象不能设置为空";locale_strings[3016]="无权访问模块数据，moduleKey 错误: {0}";locale_strings[3100]="没有定义的数据类型 : {0}";locale_strings[3101]="超出索引范围 : {0}，当前索引范围 0 ~ {1}";locale_strings[3102]="还没有设定数据源 dataProvider";locale_strings[3201]="没有找到对应的类 : {0}";var DataManager=function(){function DataManager(){_classCallCheck(this,DataManager);this._defines={};this._root={};if(DataManager.instance){return}DataManager.instance=this;this.addDefine({name:"Attribute",members:{name:{type:"string"},content:{type:"string"}}});this.addDefine({name:"Size",members:{width:{type:"int"},height:{type:"int"}}});this.addDefine({name:"Point",members:{x:{type:"int"},y:{type:"int"}}});this.addDefine({name:"RGB",members:{r:{type:"uint"},g:{type:"uint"},b:{type:"uint"}}});this.addDefine({name:"ARGB",members:{a:{type:"uint"},r:{type:"uint"},g:{type:"uint"},b:{type:"uint"}}});this.addDefine({name:"Rectangle",members:{x:{type:"int"},y:{type:"int"},width:{type:"int"},height:{type:"int"}}});this.addDefine({name:"Progress",members:{current:{type:"number"},max:{type:"number"},percent:{type:"number",bind:"{max==0?1:current/max}"},tip:{type:"string"}}});this.addDefine({name:"flower.System",members:{screen:{type:"Size"}}});this.addDefine({name:"FlowerData",members:{system:{type:"flower.System"}}});this.addRootData("flower","FlowerData")}_createClass(DataManager,[{key:"addRootData",value:function addRootData(name,className){var init=arguments.length<=2||arguments[2]===undefined?null:arguments[2];this[name]=this.createData(className,init);return this._root[name]=this[name]}},{key:"addDefine",value:function addDefine(config){var beforeScript=arguments.length<=1||arguments[1]===undefined?"":arguments[1];var className=config.name;if(!className){sys.$error(3010,flower.ObjectDo.toString(config));return}if(!this._defines[className]){this._defines[className]={id:0,className:"",define:null}}var item=this._defines[className];var packages=className.split(".");className=packages.splice(packages.length-1,1)[0];var defineClass=""+className+(item.id!=0?item.id:"");item.className=defineClass;var extendClassName="ObjectValue";if(config.extends){var extendsItem=this.getClass(config.extends);if(extendsItem){extendClassName='DataManager.getInstance().getClass("'+config.extends+'")'}else{var extendPakcages=config.extends.split(".");extendsItem=$root;for(var i=0;i<extendPakcages.length;i++){extendsItem=extendsItem[extendPakcages[i]]}if(extendsItem){extendClassName=config.extends}}if(!extendsItem){sys.$error(3013,config.extends,flower.ObjectDo.toString(config));return}}this.staticScript="";this.scriptContent=config.script;var script={content:"",ctor:""};this.decodeScript("\n\n",defineClass,script);var content=beforeScript+"\nvar "+defineClass+" = (function (_super) {\n"+"	__extends("+defineClass+", _super);\n"+"	function "+defineClass+"(init) {\n"+"		_super.call(this,null);\n";content+='		this.className = "'+config.name+'";\n';var defineMember="";var members=config.members;var bindContent="";var subContent="";var simpleType;if(members){var member;for(var key in members){member=members[key];simpleType=false;if(member.init&&_typeof(member.init)=="object"&&member.init.__className){content+='		this.$setMember("'+key+'" , flower.DataManager.getInstance().createData("'+member.init.__className+'",'+(member.init!=null?JSON.stringify(member.init):"null")+","+member.checkDistort+"));\n";content+='		this.$setMemberSaveClass("'+key+'" ,'+(member.saveClass?true:false)+");\n"}else{if(member.type==="number"||member.type==="Number"){simpleType=true;content+='		this.$setMember("'+key+'" , new NumberValue('+(member.init!=null?member.init:"null")+","+(member.enumList?JSON.stringify(member.enumList):"null")+","+member.checkDistort+"));\n"}else if(member.type==="int"||member.type==="Int"){simpleType=true;content+='		this.$setMember("'+key+'" , new IntValue('+(member.init!=null?member.init:"null")+","+(member.enumList?JSON.stringify(member.enumList):"null")+","+member.checkDistort+"));\n"}else if(member.type==="uint"||member.type==="UInt"){simpleType=true;content+='		this.$setMember("'+key+'" , new UIntValue('+(member.init!=null?member.init:"null")+","+(member.enumList?JSON.stringify(member.enumList):"null")+","+member.checkDistort+"));\n"}else if(member.type==="string"||member.type==="String"){simpleType=true;content+='		this.$setMember("'+key+'" , new StringValue('+(member.init!=null?'"'+member.init+'"':"null")+","+(member.enumList?JSON.stringify(member.enumList):"null")+"));\n"}else if(member.type==="boolean"||member.type==="Boolean"||member.type==="bool"){simpleType=true;content+='		this.$setMember("'+key+'" , new BooleanValue('+(member.init!=null?member.init:"null")+","+(member.enumList?JSON.stringify(member.enumList):"null")+"));\n"}else if(member.type==="array"||member.type==="Array"){content+='		this.$setMember("'+key+'" , new ArrayValue('+(member.init!=null?JSON.stringify(member.init):"null")+',"'+member.typeValue+'"));\n'}else if(member.type==="*"){content+='		this.$setMember("'+key+'" , '+(member.init!=null?member.init:"null")+");\n";content+='		this.$setMemberSaveClass("'+key+'" ,'+(member.saveClass?true:false)+");\n"}else{if(member.hasOwnProperty("init")&&member.init==null){content+='		this.$setMember("'+key+'" , null);\n'}else{content+='		this.$setMember("'+key+'" , flower.DataManager.getInstance().createData("'+member.type+'",'+(member.init!=null?JSON.stringify(member.init):"null")+"));\n"}content+='		this.$setMemberSaveClass("'+key+'" ,'+(member.saveClass?true:false)+");\n"}}if(member.save===true||member.save===false){content+='		this.$setMemberSaveFlag("'+key+'" ,'+member.save+");\n"}if(member.bind){bindContent+="		new flower.Binding(this.__value."+key+',[this],"value","'+member.bind+'");\n'}if(member.sub){subContent+="		this."+member.sub.source+".linkSubArrayValue(this."+key+",";if(typeof member.sub.type=="string"){subContent+='"'+member.sub.type+'",'+(typeof member.sub.value=="string"?'"'+member.sub.value+'"':member.sub.value)+");\n"}else{for(var s=0;s<member.sub.type.length;s++){subContent+='"'+member.sub.type[s]+'",'+(typeof member.sub.value[s]=="string"?'"'+member.sub.value[s]+'"':member.sub.value[s])+(s<member.sub.type.length-1?",":");\n")}}}if(member.check!=null){content+="		this.__value."+key+".check = "+member.check+";\n"}defineMember+="	Object.defineProperty("+defineClass+'.prototype,"$'+key+'", {\n';defineMember+="		get: function () {\n";defineMember+='			return this.__value["'+key+'"];\n';defineMember+="		},\n";defineMember+="		set: function (val) {\n";defineMember+="		},\n";defineMember+="		enumerable: true,\n";defineMember+="		configurable: true\n";defineMember+="	});\n\n";defineMember+="	Object.defineProperty("+defineClass+'.prototype,"'+key+'", {\n';defineMember+="		get: function () {\n";if(simpleType){defineMember+="			return this.__value."+key+".value;\n"}else{defineMember+="			return this.__value."+key+";\n"}defineMember+="		},\n";defineMember+="		set: function (val) {\n";defineMember+='			this.setValue("'+key+'", val);\n';defineMember+="		},\n";defineMember+="		enumerable: true,\n";defineMember+="		configurable: true\n";defineMember+="	});\n\n"}}if(config.init){content+="		this.value = "+JSON.stringify(config.init)+";\n"}content+="		if(init) this.value = init;\n";content+=bindContent;content+=subContent;content+=script.ctor;content+="	}\n\n"+"var p = "+defineClass+".prototype;"+"\n\n"+script.content+"\n"+defineMember+"	return "+defineClass+";\n"+"})("+extendClassName+");\n";content+="DataManager.getInstance().$addClassDefine("+defineClass+', "'+config.name+'");\n';if(config.exports){var name="";for(var i=0;i<packages.length;i++){name+=packages[i];content+="$root."+name+" = $root."+name+" || {}\n";name+="."}name+=className;content+="$root."+name+" = "+defineClass+";\n"}if(sys.TIP){flower.trace("数据结构:\n"+content)}if(sys.DEBUG){try{eval(content)}catch(e){sys.$error(3011,e,content)}}else{eval(content)}item.id++;return this.getClass(config.name)}},{key:"$addClassDefine",value:function $addClassDefine(clazz,className){var item=this._defines[className];item.define=clazz}},{key:"getClass",value:function getClass(className){var item=this._defines[className];if(!item){return null}return item.define}},{key:"createData",value:function createData(className){var init=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var distort=arguments.length<=2||arguments[2]===undefined?null:arguments[2];if(className==="number"||className==="Number"){return new NumberValue(init,null,distort)}else if(className==="int"||className==="Int"){return new IntValue(init,null,distort)}else if(className==="uint"||className==="Uint"){return new UIntValue(init,null,distort)}else if(className==="string"||className==="String"){return new StringValue(init)}else if(className==="boolean"||className==="Boolean"||className==="bool"){return new BooleanValue(init)}else if(className==="array"||className==="Array"){return new ArrayValue(init)}else if(className==="*"){return init}else{var item=this._defines[className];if(!item){sys.$error(3012,className);return}return new item.define(init)}}},{key:"decodeScript",value:function decodeScript(before,className,script){if(this.scriptContent&&this.scriptContent!=""){var scriptContent=this.scriptContent;scriptContent=flower.StringDo.deleteProgramNote(scriptContent,0);var i=0;var len=scriptContent.length;var pos=0;var list=[];this.staticScript="";while(true){var nextFunction=this.findNextFunction(scriptContent,pos);if(nextFunction){this.staticScript+=nextFunction.staticScript;pos=nextFunction.endIndex;list.push(nextFunction)}else{break}}for(var i=0;i<list.length;i++){var func=list[i];if(func.name=="constructor"){script.ctor=before+func.content+"\n"}else if(func.gset==0){script.content+=before+"	"+className+(func.isStatic?".":".prototype.")+func.name+" = function("+func.params+") "+func.content+"\n"}else{var setContent=func.gset==1?"":func.content;var getContent=func.gset==1?func.content:"";var prams=func.gset==1?"":func.params;for(var f=0;f<list.length;f++){if(f!=i&&list[f].name==func.name&&list[f].gset&&list[f].gset!=func.gset){if(list[f].gset==1){getContent=list[f].content}else{setContent=list[f].content;prams=list[f].params}list.splice(f,1);break}}script.content+=before+"	Object.defineProperty("+className+'.prototype, "'+func.name+'", {\n';if(getContent!=""){script.content+=before+"		get: function () "+getContent+",\n"}if(setContent!=""){script.content+=before+"		set: function ("+prams+") "+setContent+",\n"}script.content+=before+"		enumerable: true,\n";script.content+=before+"		configurable: true\n";script.content+=before+"		});\n\n"}}}}},{key:"findNextFunction",value:function findNextFunction(content,start){var len="function".length;var flag;var name;var params;var char;var pos,pos2,i;var res;var gset=0;var funcName;var isStatic=false;i=flower.StringDo.jumpProgramSpace(content,start);if(i==content.length){return null}var j=i;while(j<content.length){if(content.slice(j,j+"static".length)=="static"||content.slice(j,j+len)=="function"){break}j++}if(j==content.length){this.staticScript+=content.slice(i,j);return null}var staticScript=content.slice(i,j);i=j;if(content.slice(i,i+"static".length)=="static"){isStatic=true;i+="static".length;i=flower.StringDo.jumpProgramSpace(content,i)}if(content.slice(i,i+len)=="function"){if(i!=0){char=content.charAt(i-1);if(char!="	"&&char!=" "&&char!="\r"&&char!="\n"){sys.$error(3007,"",this.scriptContent)}}i=pos=i+len;pos2=flower.StringDo.jumpProgramSpace(content,pos);if(pos2==pos){sys.$error(3007,"",this.scriptContent)}pos=pos2;name=flower.StringDo.findId(content,pos);if(name==""){i=pos;sys.$error(3007,"",this.scriptContent)}if(name=="get"||name=="set"){pos+=name.length;gset=name=="get"?1:2;pos2=flower.StringDo.jumpProgramSpace(content,pos);if(pos2==pos){sys.$error(3007,"",this.scriptContent)}pos=pos2;name=flower.StringDo.findId(content,pos);if(name==""){i=pos;sys.$error(3007,"",this.scriptContent)}}funcName=name;i=pos=flower.StringDo.jumpProgramSpace(content,pos+name.length);char=content.charAt(pos);if(char!="("){sys.$error(3007,"",this.scriptContent)}pos++;params="";flag=true;while(true){pos=flower.StringDo.jumpProgramSpace(content,pos);name=flower.StringDo.findId(content,pos);if(name==""){if(content.charAt(pos)==")"){i=pos+1;break}else{flag=false;break}}else{params+=name;pos+=name.length}pos=flower.StringDo.jumpProgramSpace(content,pos);char=content.charAt(pos);if(char==","){params+=",";pos++}}if(!flag){sys.$error(3007,"",this.scriptContent)}res={name:funcName,gset:gset,params:params}}if(!res){sys.$error(3007,"",this.scriptContent)}var content=flower.StringDo.findFunctionContent(content,i);if(content==""){sys.$error(3007,"",this.scriptContent)}res.staticScript=staticScript||"";res.content=content;res.endIndex=i+content.length+1;res.isStatic=isStatic;return res}},{key:"clear",value:function clear(){for(var key in this._root){delete this._root[key];delete this[key]}this._defines={}}}],[{key:"getInstance",value:function getInstance(){if(DataManager.instance==null){new DataManager}return DataManager.instance}},{key:"addRootData",value:function addRootData(name,className){var init=arguments.length<=2||arguments[2]===undefined?null:arguments[2];return DataManager.getInstance().addRootData(name,className,init)}},{key:"getClass",value:function getClass(className){return DataManager.getInstance().getClass(className)}},{key:"addDefine",value:function addDefine(config){var beforeScript=arguments.length<=1||arguments[1]===undefined?"":arguments[1];return DataManager.getInstance().addDefine(config,beforeScript)}},{key:"createData",value:function createData(className){var init=arguments.length<=1||arguments[1]===undefined?null:arguments[1];return DataManager.getInstance().createData(className,init)}},{key:"clear",value:function clear(){DataManager.getInstance().clear()}}]);return DataManager}();black.DataManager=DataManager;var Layout=function(){function Layout(){_classCallCheck(this,Layout);this._fixElementSize=false;this.elements=[];this.flag=false}_createClass(Layout,[{key:"isElementsOutSize",value:function isElementsOutSize(startX,starY,width,height){return false}},{key:"getFirstItemIndex",value:function getFirstItemIndex(elementWidth,elementHeight,startX,startY){return 0}},{key:"getContentSize",value:function getContentSize(){return null}},{key:"measureSize",value:function measureSize(elementWidth,elementHeight,elementCount){return null}},{key:"addElementAt",value:function addElementAt(element,index){var len=this.elements.length;for(var i=0;i<len;i++){if(this.elements[i]==element){this.elements.splice(i,1);break}}this.elements.splice(index,0,element);this.flag=true}},{key:"setElementIndex",value:function setElementIndex(element,index){var len=this.elements.length;for(var i=0;i<len;i++){if(this.elements[i]==element){this.elements.splice(i,1);break}}this.elements.splice(index,0,element);this.flag=true}},{key:"removeElement",value:function removeElement(element){var len=this.elements.length;for(var i=0;i<len;i++){if(this.elements[i]==element){this.elements.splice(i,1);break}}this.flag=true}},{key:"removeElementAt",value:function removeElementAt(index){this.elements.splice(index,1);this.flag=true}},{key:"$setFlag",value:function $setFlag(){this.flag=true}},{key:"updateList",value:function updateList(width,height){var startIndex=arguments.length<=2||arguments[2]===undefined?0:arguments[2];var elementWidth=arguments.length<=3||arguments[3]===undefined?0:arguments[3];var elementHeight=arguments.length<=4||arguments[4]===undefined?0:arguments[4]}},{key:"$clear",value:function $clear(){this.elements=[];this.flag=false}},{key:"fixElementSize",get:function get(){return this._fixElementSize},set:function set(val){if(val=="false"){val=false}this._fixElementSize=!!val}}]);return Layout}();Layout.VerticalAlign="vertical";Layout.HorizontalAlign="horizontal";Layout.NoneAlign="";black.Layout=Layout;var LinearLayout=function(_Layout){_inherits(LinearLayout,_Layout);function LinearLayout(){_classCallCheck(this,LinearLayout);var _this9=_possibleConstructorReturn(this,Object.getPrototypeOf(LinearLayout).call(this));_this9._gap=0;_this9._align="";_this9._fixElementSize=true;return _this9}_createClass(LinearLayout,[{key:"isElementsOutSize",value:function isElementsOutSize(startX,starY,width,height){if(this._align==flower.Layout.VerticalAlign){if(starY+height<=this._maxY){return true}}if(this._align==flower.Layout.HorizontalAlign){if(startX+width<=this._maxX){return true}}return false}},{key:"getFirstItemIndex",value:function getFirstItemIndex(elementWidth,elementHeight,startX,startY){if(this._align==flower.Layout.VerticalAlign){return Math.floor(startY/(elementHeight+this._gap))}else if(this._align==flower.Layout.HorizontalAlign){return Math.floor(startX/(elementWidth+this._gap))}return 0}},{key:"getContentSize",value:function getContentSize(){var size=flower.Size.create(0,0);if(!this.elements.length){return size}var minX=this.elements[0].x;var maxX=this.elements[0].x+this.elements[0].width;var minY=this.elements[0].y;var maxY=this.elements[0].y+this.elements[0].height;var element;for(var i=1;i<this.elements.length;i++){element=this.elements[i];minX=element.x<minX?element.x:minX;maxX=element.x+element.width>maxX?element.x+element.width:maxX;minY=element.y<minY?element.y:minY;maxY=element.y+element.height>maxY?element.y+element.height:maxY}size.width=maxX-minX;size.height=maxY-minY;return size}},{key:"measureSize",value:function measureSize(elementWidth,elementHeight,elementCount){var size=flower.Size.create(elementWidth,elementHeight);if(this.elements.length){if(this._fixElementSize){if(this._align==flower.Layout.VerticalAlign){size.height=elementCount*(elementHeight+this._gap)}else if(this._align==flower.Layout.HorizontalAlign){size.width=elementCount*(elementWidth+this._gap)}}}return size}},{key:"updateList",value:function updateList(width,height){var startIndex=arguments.length<=2||arguments[2]===undefined?0:arguments[2];var elementWidth=arguments.length<=3||arguments[3]===undefined?0:arguments[3];var elementHeight=arguments.length<=4||arguments[4]===undefined?0:arguments[4];if(!this.flag){return}var list=this.elements;var len=list.length;if(!len){return}this._maxX=0;this._maxY=0;var i;if(this._align==flower.Layout.VerticalAlign){if(this._fixElementSize){if(list.length){elementHeight=elementHeight||list[0].height}for(i=0;i<len;i++){list[i].y=(i+startIndex)*(elementHeight+this._gap)}this._maxY=(len+startIndex)*(elementHeight+this._gap)}else{var y=0;for(i=0;i<len;i++){list[i].y=y;y+=list[i].height+this._gap;this._maxY=y}}}if(this._align==flower.Layout.HorizontalAlign){if(this._fixElementSize){if(list.length){elementWidth=elementWidth||list[0].height}for(i=0;i<len;i++){list[i].x=(i+startIndex)*(elementWidth+this._gap)}this._maxX=(len+startIndex)*(elementWidth+this._gap)}else{var x=0;for(i=0;i<len;i++){list[i].x=x;x+=list[i].width+this._gap;this._maxX=x}}}}},{key:"gap",get:function get(){return this._gap},set:function set(val){val=+val||0;this._gap=val}},{key:"align",get:function get(){return this._align},set:function set(val){this._align=val}}]);return LinearLayout}(Layout);var HorizontalLayout=function(_LinearLayout){_inherits(HorizontalLayout,_LinearLayout);function HorizontalLayout(){_classCallCheck(this,HorizontalLayout);var _this10=_possibleConstructorReturn(this,Object.getPrototypeOf(HorizontalLayout).call(this));_this10.align=flower.Layout.HorizontalAlign;return _this10}return HorizontalLayout}(LinearLayout);black.HorizontalLayout=HorizontalLayout;var VerticalLayout=function(_LinearLayout2){_inherits(VerticalLayout,_LinearLayout2);function VerticalLayout(){_classCallCheck(this,VerticalLayout);var _this11=_possibleConstructorReturn(this,Object.getPrototypeOf(VerticalLayout).call(this));_this11.align=flower.Layout.VerticalAlign;return _this11}return VerticalLayout}(LinearLayout);black.VerticalLayout=VerticalLayout;var Language=function(){function Language(){_classCallCheck(this,Language)}_createClass(Language,null,[{key:"register",value:function register(key,language,value){if(!Language.__languages[language]){Language.__languages[language]={}}Language.__languages[language][key]=value}},{key:"getLanguage",value:function getLanguage(key,language){return Language.__languages[language][key]}}]);return Language}();Language.__languages={};black.Language=Language;var PanelScaleMode=function PanelScaleMode(){_classCallCheck(this,PanelScaleMode)};PanelScaleMode.NO_SCALE="no_scale";PanelScaleMode.SHOW_ALL="show_all";PanelScaleMode.NO_BORDER="no_border";PanelScaleMode.SCALE_WIDTH="scale_width";PanelScaleMode.SCALE_HEIGHT="scale_height";black.PanelScaleMode=PanelScaleMode;var ScrollPolicy=function ScrollPolicy(){_classCallCheck(this,ScrollPolicy)};ScrollPolicy.ON="on";ScrollPolicy.OFF="off";ScrollPolicy.AUTO="auto";black.ScrollPolicy=ScrollPolicy;var Group=function(_flower$Sprite){_inherits(Group,_flower$Sprite);function Group(data){_classCallCheck(this,Group);var _this12=_possibleConstructorReturn(this,Object.getPrototypeOf(Group).call(this));if(data!=null){_this12._data=data}_this12.$IViewPort={0:0,1:0,2:0,3:0,4:null,5:null};_this12.$initUIComponent();return _this12}_createClass(Group,[{key:"setData",value:function setData(val){if(val&&typeof val=="string"){val=flower.DataManager.getInstance().createData(val)}if(this._data==val){return false}this._data=val;if(this.$UIComponent){flower.Binding.changeData(this)}return true}},{key:"$addFlags",value:function $addFlags(flags){if((flags&1)==1&&(this.__flags&4096)!=4096&&(!this.parent||!this.parent.__UIComponent)){this.__flags|=4096;if(this.layout){this.__flags|=8192}}this.__flags|=flags}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){this.$removeFlags(4096);var p=this.$UIComponent;if(this.$hasFlags(1)){this.$getContentBounds()}parent=parent||this.parent;if(p[0]!=null&&p[1]==null&&p[2]!=null){this.width=(p[2]-p[0])*2;this.x=p[0]}else if(p[0]==null&&p[1]!=null&&p[2]!=null){this.width=(p[1]-p[2])*2;this.x=2*p[2]-p[1]}else if(p[0]!=null&&p[1]!=null){this.width=parent.width-p[1]-p[0];this.x=p[0]}else{if(p[0]!=null){this.x=p[0]}if(p[1]!=null){this.x=parent.width-p[1]-this.width*this.scaleX}if(p[2]!=null){this.x=(parent.width-this.width*this.scaleX)*.5+p[2]}if(p[6]){this.width=parent.width*p[6]/100}}if(p[3]!=null&&p[4]==null&&p[5]!=null){this.height=(p[5]-p[3])*2;this.y=p[3]}else if(p[3]==null&&p[4]!=null&&p[5]!=null){this.height=(p[4]-p[5])*2;this.y=2*p[5]-p[4]}else if(p[3]!=null&&p[4]!=null){this.height=parent.height-p[4]-p[3];this.y=p[3]}else{if(p[3]!=null){this.y=p[3]}if(p[4]!=null){this.y=parent.height-p[4]-this.height*this.scaleY}if(p[5]!=null){this.y=(parent.height-this.height*this.scaleY)*.5+p[5]}if(p[7]){this.height=parent.height*p[7]/100}}this.$validateChildrenUIComponent();this.$IViewPort[0]=this.$childrenBounds.x;this.$IViewPort[1]=this.$childrenBounds.y;this.$IViewPort[2]=this.$childrenBounds.x+this.$childrenBounds.width;this.$IViewPort[3]=this.$childrenBounds.y+this.$childrenBounds.height}},{key:"$validateChildrenUIComponent",value:function $validateChildrenUIComponent(){var children=this.__children;if(children){var child;for(var i=0,len=children.length;i<len;i++){child=children[i];if(child.__UIComponent&&child.$UIComponent[15]){child.$validateUIComponent()}}}}},{key:"$resetLayout",value:function $resetLayout(){if(this.$hasFlags(this.layout&&8192)){this.$removeFlags(8192);this.layout.updateList(this.width,this.height)}}},{key:"$onFrameEnd",value:function $onFrameEnd(){
if(!this.parent.__UIComponent){var flag=false;var count=6;while(count&&this.$hasFlags(4096)){this.$validateUIComponent();var children=this.__children;if(this.$hasFlags(256)){if(!this.$nativeShow){$warn(1002,this.name);return}this.$nativeShow.resetChildIndex(children);this.$removeFlags(256)}for(var i=0,len=children.length;i<len;i++){if(children[i].visible){children[i].$onFrameEnd()}}var p=this.$DisplayObject;if(this.$hasFlags(2)){this.$nativeShow.setAlpha(this.$getConcatAlpha())}this.$resetLayout();flag=true;count--}if(!flag){var children=this.__children;if(this.$hasFlags(256)){if(!this.$nativeShow){$warn(1002,this.name);return}this.$nativeShow.resetChildIndex(children);this.$removeFlags(256)}for(var i=0,len=children.length;i<len;i++){if(children[i].visible){children[i].$onFrameEnd()}}var p=this.$DisplayObject;if(this.$hasFlags(2)){this.$nativeShow.setAlpha(this.$getConcatAlpha())}this.$resetLayout()}while(count&&this.$hasFlags(4096)){this.$validateUIComponent();var children=this.__children;if(this.$hasFlags(256)){if(!this.$nativeShow){$warn(1002,this.name);return}this.$nativeShow.resetChildIndex(children);this.$removeFlags(256)}for(var i=0,len=children.length;i<len;i++){if(children[i].visible){children[i].$onFrameEnd()}}var p=this.$DisplayObject;if(this.$hasFlags(2)){this.$nativeShow.setAlpha(this.$getConcatAlpha())}this.$resetLayout();flag=true;count--}}else{var children=this.__children;if(this.$hasFlags(256)){if(!this.$nativeShow){$warn(1002,this.name);return}this.$nativeShow.resetChildIndex(children);this.$removeFlags(256)}for(var i=0,len=children.length;i<len;i++){if(children[i].visible){children[i].$onFrameEnd()}}var p=this.$DisplayObject;if(this.$hasFlags(2)){this.$nativeShow.setAlpha(this.$getConcatAlpha())}this.$resetLayout()}flower.DebugInfo.frameInfo.display++;flower.DebugInfo.frameInfo.sprite++}},{key:"$getContentWidth",value:function $getContentWidth(){return this.$IViewPort[2]-this.$IViewPort[0]}},{key:"$getContentHeight",value:function $getContentHeight(){return this.$IViewPort[3]-this.$IViewPort[1]}},{key:"dispose",value:function dispose(){flower.Binding.removeChangeObject(this);this.removeAllBindProperty();this.$UIComponent[11].dispose();_get(Object.getPrototypeOf(Group.prototype),"dispose",this).call(this)}},{key:"data",get:function get(){return this._data},set:function set(val){this.setData(val)}},{key:"contentWidth",get:function get(){return this.$getContentWidth()}},{key:"contentHeight",get:function get(){return this.$getContentHeight()}},{key:"scrollH",get:function get(){return this.$IViewPort[4]==null?this.$IViewPort[0]:this.$IViewPort[4]},set:function set(val){if(val!=null){val=+val}if(this.$IViewPort[4]==val){return}this.$IViewPort[4]=val}},{key:"scrollV",get:function get(){return this.$IViewPort[5]==null?this.$IViewPort[1]:this.$IViewPort[5]},set:function set(val){if(val!=null){val=+val}if(this.$IViewPort[5]==val){return}this.$IViewPort[5]=val}}]);return Group}(flower.Sprite);UIComponent.register(Group,true);Group.prototype.__UIComponent=true;black.Group=Group;var UIParser=function(_Group){_inherits(UIParser,_Group);function UIParser(){var beforeScript=arguments.length<=0||arguments[0]===undefined?"":arguments[0];_classCallCheck(this,UIParser);var _this13=_possibleConstructorReturn(this,Object.getPrototypeOf(UIParser).call(this));_this13.defaultClassName="";_this13.moduleName="local";_this13.namespaces={};_this13._beforeScript=beforeScript;_this13.classes=flower.UIParser.classes;_this13.percentWidth=_this13.percentHeight=100;return _this13}_createClass(UIParser,[{key:"parseUIAsync",value:function parseUIAsync(url){var data=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(this.classes.uiModule[url]){this.moduleName=this.classes.uiModule[url];if(this._beforeScript==""&&flower.UIParser.classes.beforeScripts[this.moduleName]){this._beforeScript=flower.UIParser.classes.beforeScripts[this.moduleName]}}if(this.classes.defaultClassNames[url]){this.defaultClassName=this.classes.defaultClassNames[url]}this.loadURL=url;this.loadData=data;var loader=new flower.URLLoader(url);loader.addListener(flower.Event.COMPLETE,this.loadContentComplete,this);loader.addListener(flower.Event.ERROR,this.loadContentError,this);loader.load();this.parseUIAsyncFlag=true}},{key:"parseAsync",value:function parseAsync(url){if(this.classes.uiModule[url]){this.moduleName=this.classes.uiModule[url];if(this._beforeScript==""&&flower.UIParser.classes.beforeScripts[this.moduleName]){this._beforeScript=flower.UIParser.classes.beforeScripts[this.moduleName]}}if(this.classes.defaultClassNames[url]){this.defaultClassName=this.classes.defaultClassNames[url]}this.loadURL=url;var loader=new flower.URLLoader(url);loader.addListener(flower.Event.COMPLETE,this.loadContentComplete,this);loader.addListener(flower.Event.ERROR,this.loadContentError,this);loader.load();this.parseUIAsyncFlag=false}},{key:"loadContentError",value:function loadContentError(e){if(this.hasListener(flower.Event.ERROR)){this.dispatchWith(flower.Event.ERROR,sys.getLanguage(3001,e.currentTarget.url))}else{sys.$error(3001,e.currentTarget.url)}}},{key:"loadContentComplete",value:function loadContentComplete(e){this.relationUI=[];var xml=flower.XMLElement.parse(e.data);for(var i=0;i<xml.namespaces.length;i++){if(xml.namespaces[i].name=="f"){continue}var moduleURL=xml.namespaces[i].value;if(moduleURL.slice(0,2)=="./"){moduleURL=flower.Path.joinPath(this.loadURL,moduleURL)}this.namespaces[xml.namespaces[i].name]=this.classes.namespaces[moduleURL];if(!this.namespaces[xml.namespaces[i].name]){sys.$error(3004,xml.namespaces[i].name,xml.namespaces[i].value)}}this.loadContent=xml;var list=xml.getAllElements();var scriptURL="";for(var i=0;i<list.length;i++){var name=list[i].name;var nameSpace=name.split(":")[0];name=name.split(":")[1];if(nameSpace!="f"){nameSpace=this.namespaces[nameSpace];if(!this.classes[nameSpace][name]&&!this.classes[nameSpace+"Content"][name]){if(!this.classes[nameSpace+"URL"][name]){sys.$error(3002,name);return}var find=false;for(var f=0;f<this.relationUI.length;f++){if(this.relationUI[f].url==this.classes[nameSpace+"URL"][name]){find=true;break}}if(!find){this.relationUI.push({namesapce:nameSpace,url:this.classes[nameSpace+"URL"][name],name:name})}}}if(nameSpace=="f"&&name=="script"&&list[i].getAttribute("src")){scriptURL=list[i].getAttribute("src").value}}this.relationIndex=0;if(scriptURL!=""){if(scriptURL.slice(0,2)=="./"){if(this.loadURL.split("/").length==1){scriptURL=scriptURL.slice(2,scriptURL.length)}else{scriptURL=this.loadURL.slice(0,this.loadURL.length-this.loadURL.split("/")[this.loadURL.split("/").length-1].length)+scriptURL.slice(2,scriptURL.length)}}this.loadScript(scriptURL)}else{this.loadNextRelationUI()}}},{key:"loadScript",value:function loadScript(url){this.scriptURL=url;var loader=new flower.URLLoader(url);loader.addListener(flower.Event.COMPLETE,this.loadScriptComplete,this);loader.addListener(flower.Event.ERROR,this.loadContentError,this);loader.load()}},{key:"loadScriptComplete",value:function loadScriptComplete(e){this.scriptContent=e.data;this.loadNextRelationUI()}},{key:"loadNextRelationUI",value:function loadNextRelationUI(){var e=arguments.length<=0||arguments[0]===undefined?null:arguments[0];if(e){this.relationIndex++}if(this.relationIndex>=this.relationUI.length){if(this.parseUIAsyncFlag){var ui=this.parseUI(this.loadContent,this.loadData);this.dispatchWith(flower.Event.COMPLETE,ui)}else{var data=this.parse(this.loadContent);this.dispatchWith(flower.Event.COMPLETE,data)}}else{var parser=new UIParser;parser.defaultClassName=this.relationUI[this.relationIndex].name;parser.moduleName=this.relationUI[this.relationIndex].namesapce;parser.parseAsync(this.relationUI[this.relationIndex].url);parser.addListener(flower.Event.COMPLETE,this.loadNextRelationUI,this);parser.addListener(flower.Event.ERROR,this.relationLoadError,this)}}},{key:"relationLoadError",value:function relationLoadError(e){if(this.hasListener(flower.Event.ERROR)){this.dispatchWith(flower.Event.ERROR,e.data)}else{$error(e.data)}}},{key:"parseUI",value:function parseUI(content){var data=arguments.length<=1||arguments[1]===undefined?null:arguments[1];this.parse(content);var className=this._className;var namesapce=this.moduleName;var UIClass=this.classes[namesapce][className];var ui;if(data){ui=new UIClass(data)}else{ui=new UIClass}if(!ui.parent){this.addChild(ui)}return ui}},{key:"parse",value:function parse(content){this.parseContent=content;var xml;if(typeof content=="string"){xml=flower.XMLElement.parse(content)}else{xml=content}if(xml.getNameSapce("f")==null||xml.getNameSapce("f").value!="flower"){sys.$error(3006,content);return null}for(var i=0;i<xml.namespaces.length;i++){if(xml.namespaces[i].name=="f"){continue}var moduleURL=xml.namespaces[i].value;if(moduleURL.slice(0,2)=="./"){if(!this.loadURL||!moduleURL){flower.breakPoint()}moduleURL=flower.Path.joinPath(this.loadURL,moduleURL)}this.namespaces[xml.namespaces[i].name]=this.classes.namespaces[moduleURL];if(!this.namespaces[xml.namespaces[i].name]){sys.$error(3004,xml.namespaces[i].name,xml.namespaces[i].value)}}this.rootXML=xml;var classInfo=this.decodeRootComponent(xml,content);var namesapce=classInfo.namesapce;var className=classInfo.className;this.parseContent="";this._className=className;this._classNameSpace=classInfo.namesapce;this.rootXML=null;return classInfo.className}},{key:"decodeRootComponent",value:function decodeRootComponent(xml,classContent){var content=this._beforeScript;var namespacesList=xml.namespaces;var namespaces={};for(var i=0;i<namespacesList.length;i++){namespaces[namespacesList[i].name]=namespacesList[i].value}var uiname=xml.name;var uinameNS=uiname.split(":")[0];var extendClass="";uiname=uiname.split(":")[1];var className="";var allClassName="";var packages=[];if(uinameNS!="f"){uinameNS=this.namespaces[uinameNS];extendClass=uiname}else{extendClass=this.classes[uinameNS][uiname];if(!extendClass&&this.classes[uinameNS+"Content"][extendClass]){this.parse(this.classes[uinameNS+"Content"][extendClass])}}var classAtr=xml.getAttribute("class");if(classAtr){className=classAtr.value;allClassName=className;packages=className.split(".");if(packages.length>1){className=packages[packages.length-1];packages.pop()}else{packages=[]}}else{if(this.defaultClassName&&this.defaultClassName!=""){className=this.defaultClassName;allClassName=className}else{className="$UI"+UIParser.id++;allClassName=className}}var changeAllClassName=allClassName;if(uinameNS!="f"&&this.classes[uinameNS][allClassName]){if(this.classes[uinameNS+"Content"][allClassName]==classContent){return allClassName}else{changeAllClassName=changeAllClassName.slice(0,changeAllClassName.length-className.length);className="$UI"+UIParser.id++;changeAllClassName+=className}}var before="";for(var i=0;i<packages.length;i++){content+=before+"var "+packages[i]+";\n";content+=before+"(function ("+packages[i]+") {\n";before+="	"}content+=(packages.length?before:"")+"var "+className+" = (function (_super) {\n";content+=before+"	__extends("+className+", _super);\n";content+=before+"	function "+className+"(data) {\n";content+=before+"		 _super.call(this);\n";content+=before+"		this."+className+"_binds = [];\n";var scriptInfo={content:""};this.hasInitFunction=false;content+=this.decodeScripts(before,className,xml.getElements("f:script"),scriptInfo);content+=before+"		this."+className+"_initMain(this);\n";var propertyList=[];this.decodeObject(before+"	",className,className+"_initMain",false,xml,namespaces,propertyList,{});if(this.hasInitFunction){content+=before+"		this."+className+"_init();\n"}content+=before+"		if(data) this.data = data;\n";content+=before+"		this."+className+"_setBindProperty"+"();\n";content+=before+"		if(this.dispatchWith) this.dispatchWith(flower.Event.CREATION_COMPLETE);\n";content+=before+"	}\n\n";content+=propertyList[propertyList.length-1];for(var i=0;i<propertyList.length-1;i++){content+=propertyList[i]}content+=scriptInfo.content;content+=before+"	"+className+".prototype."+className+"_setBindProperty = function() {\n";content+=before+"		for(var i = 0; i < this."+className+"_binds.length; i++) this."+className+"_binds[i][0].bindProperty(this."+className+"_binds[i][1],this."+className+"_binds[i][2],[this]);\n";content+=before+"	}\n\n";content+=this.staticScript||"";content+=before+"	return "+className+";\n";if(uinameNS=="f"){content+=before+"})("+extendClass+");\n"}else{content+=before+'})(flower.UIParser.getLocalUIClass("'+extendClass+'","'+uinameNS+'"));\n'}before="";var classEnd="";for(var i=0;i<packages.length;i++){if(i==0){classEnd=before+"})("+packages[i]+" || ("+packages[i]+" = {}));\n"+classEnd}else{classEnd=before+"})("+packages[i]+" = "+packages[i-1]+"."+packages[i]+" || ("+packages[i-1]+"."+packages[i]+" = {}));\n"+classEnd}before+="	";if(i==packages.length-1){classEnd=before+packages[i]+"."+className+" = "+className+";\n"+classEnd}}content+=classEnd;content+='\n\nUIParser.registerLocalUIClass("'+allClassName+'", '+changeAllClassName+',"'+this.moduleName+'");\n';var pkg="";var pkgs=flower.UIParser.classes.packages[this.moduleName]||[];pkgs=pkgs.concat(packages);for(var i=0;i<pkgs.length;i++){pkg=pkgs[i];content+="if($root."+pkg+" == null) $root."+pkg+" = {};\n";pkg+="."}content+="$root."+pkg+allClassName+" = "+allClassName;if(sys.TIP){trace("解析类:\n",content)}if(sys.DEBUG){try{eval(content)}catch(e){sys.$error(3003,e,this.parseContent,content)}}else{eval(content)}flower.UIParser.setLocalUIClassContent(allClassName,classContent,this.moduleName);return{namesapce:uinameNS,className:allClassName}}},{key:"decodeScripts",value:function decodeScripts(before,className,scripts,script){var content="";if(this.scriptContent&&this.scriptContent!=""){var scriptContent=this.scriptContent;scriptContent=flower.StringDo.deleteProgramNote(scriptContent,0);var i=0;var len=scriptContent.length;var pos=0;var list=[];this.staticScript="";while(true){var nextFunction=this.findNextFunction(scriptContent,pos);if(nextFunction){this.staticScript+=nextFunction.staticScript;pos=nextFunction.endIndex;list.push(nextFunction)}else{break}}for(var i=0;i<list.length;i++){var func=list[i];if(func.gset==0){script.content+=before+"	"+className+(func.isStatic?".":".prototype.")+func.name+" = function("+func.params+") "+func.content+"\n"}else{var setContent=func.gset==1?"":func.content;var getContent=func.gset==1?func.content:"";var prams=func.gset==1?"":func.params;for(var f=0;f<list.length;f++){if(f!=i&&list[f].name==func.name&&list[f].gset&&list[f].gset!=func.gset){if(list[f].gset==1){getContent=list[f].content}else{setContent=list[f].content;prams=list[f].params}list.splice(f,1);break}}script.content+=before+"	Object.defineProperty("+className+'.prototype, "'+func.name+'", {\n';if(getContent!=""){script.content+="		get: function () "+getContent+",\n"}if(setContent!=""){script.content+="		set: function ("+prams+") "+setContent+",\n"}script.content+="		enumerable: true,\n";script.content+="		configurable: true\n";script.content+="		});\n\n"}}}else{for(var i=0;i<scripts.length;i++){for(var s=0;s<scripts[i].list.length;s++){var item=scripts[i].list[s];var childName=item.name;childName=childName.split(":")[1];if(item.list.length&&item.getElement("f:set")||item.getElement("f:get")){var setFunction=item.getElement("f:set");var getFunction=item.getElement("f:get");script.content+=before+"	Object.defineProperty("+className+'.prototype, "'+childName+'", {\n';if(getFunction){script.content+="		get: function () {\n";script.content+="			"+getFunction.value+"\n";script.content+="		},\n"}if(setFunction){script.content+="		set: function (val) {\n";script.content+="			"+setFunction.value+"\n";script.content+="		},\n"}script.content+="		enumerable: true,\n";script.content+="		configurable: true\n";script.content+="		});\n\n"}else if(item.value==null||item.value==""){var initValue=item.getAttribute("init");content+=before+"		this."+childName+" = "+(initValue==null?"null":initValue.value)+";\n"}else{script.content+=before+"	"+className+".prototype."+childName+" = function(";var params=item.getAttribute("params");if(params){script.content+=params.value}script.content+=") {\n";script.content+="		"+item.value;script.content+="	}\n\n"}}}}return content}},{key:"findNextFunction",value:function findNextFunction(content,start){var len="function".length;var flag;var name;var params;var char;var pos,pos2,i;var res;var gset=0;var funcName;var isStatic=false;i=flower.StringDo.jumpProgramSpace(content,start);if(i==content.length){return null}var j=i;while(j<content.length){if(content.slice(j,j+"static".length)=="static"||content.slice(j,j+len)=="function"){break}j++}if(j==content.length){this.staticScript+=content.slice(i,j);return null}var staticScript=content.slice(i,j);i=j;if(content.slice(i,i+"static".length)=="static"){isStatic=true;i+="static".length;i=flower.StringDo.jumpProgramSpace(content,i)}if(content.slice(i,i+len)=="function"){if(i!=0){char=content.charAt(i-1);if(char!="	"&&char!=" "&&char!="\r"&&char!="\n"){sys.$error(3007,this.scriptURL,this.scriptContent)}}i=pos=i+len;pos2=flower.StringDo.jumpProgramSpace(content,pos);if(pos2==pos){sys.$error(3007,this.scriptURL,this.scriptContent)}pos=pos2;name=flower.StringDo.findId(content,pos);if(name==""){i=pos;sys.$error(3007,this.scriptURL,this.scriptContent)}if(name=="get"||name=="set"){pos+=name.length;gset=name=="get"?1:2;pos2=flower.StringDo.jumpProgramSpace(content,pos);if(pos2==pos){sys.$error(3007,this.scriptURL,this.scriptContent)}pos=pos2;name=flower.StringDo.findId(content,pos);if(name==""){i=pos;sys.$error(3007,this.scriptURL,this.scriptContent)}}funcName=name;i=pos=flower.StringDo.jumpProgramSpace(content,pos+name.length);char=content.charAt(pos);if(char!="("){sys.$error(3007,this.scriptURL,this.scriptContent)}pos++;params="";flag=true;while(true){pos=flower.StringDo.jumpProgramSpace(content,pos);name=flower.StringDo.findId(content,pos);if(name==""){if(content.charAt(pos)==")"){i=pos+1;break}else{flag=false;break}}else{params+=name;pos+=name.length}pos=flower.StringDo.jumpProgramSpace(content,pos);char=content.charAt(pos);if(char==","){params+=",";pos++}}if(!flag){sys.$error(3007,this.scriptURL,this.scriptContent)}res={name:funcName,gset:gset,params:params}}if(!res){sys.$error(3007,this.scriptURL,this.scriptContent)}var content=flower.StringDo.findFunctionContent(content,i);if(content==""){sys.$error(3007,this.scriptURL,this.scriptContent)}res.staticScript=staticScript||"";res.content=content;res.endIndex=i+content.length+1;res.isStatic=isStatic;return res}},{key:"decodeObject",value:function decodeObject(before,className,funcName,createClass,xml,namespaces,propertyFunc,nameIndex){var setObject=before+className+".prototype."+funcName+" = function(parentObject) {\n";var thisObj="parentObject";var createClassName;if(createClass){var createClassNameSpace=xml.name.split(":")[0];createClassName=xml.name.split(":")[1];if(createClassNameSpace!="f"&&createClassName=="Object"){thisObj="object";setObject+=before+"	"+thisObj+" = {};\n"}else{thisObj=createClassName.split(".")[createClassName.split(".").length-1];thisObj=thisObj.toLocaleLowerCase();if(createClassNameSpace!="f"){setObject+=before+"	var "+thisObj+' = new (flower.UIParser.getLocalUIClass("'+createClassName+'","'+this.namespaces[createClassNameSpace]+'"))();\n'}else{setObject+=before+"	var "+thisObj+" = new "+this.classes.f[createClassName]+"();\n"}setObject+=before+"	if("+thisObj+".__UIComponent) "+thisObj+".eventThis = this;\n";setObject+=before+"	if("+thisObj+".__UIComponent) "+thisObj+'.$filePath = "'+this.loadURL+'";\n'}}var idAtr=xml.getAttribute("id");if(idAtr){setObject+=before+"	this."+idAtr.value+" = "+thisObj+";\n";setObject+=before+"	this."+idAtr.value+'.name = "'+idAtr.value+'";\n'}for(var i=0;i<xml.attributes.length;i++){var atrName=xml.attributes[i].name;var atrValue=xml.attributes[i].value;var atrArray=atrName.split(".");if(atrName=="class"){}else if(atrName=="id"){}else if(atrArray.length==2){var atrState=atrArray[1];atrName=atrArray[0];setObject+=before+"	"+thisObj+'.setStatePropertyValue("'+atrName+'", "'+atrState+'", "'+atrValue+'", [this]);\n'}else if(atrArray.length==1){if(atrValue.indexOf("{")>=0&&atrValue.indexOf("}")>=0){setObject+=before+"	if("+thisObj+".__UIComponent) ";setObject+="this."+className+"_binds.push(["+thisObj+',"'+atrName+'", "'+atrValue+'"]);\n';setObject+=before+"	else "+thisObj+"."+atrName+" = "+(this.isNumberOrBoolean(atrValue)?atrValue:'"'+atrValue+'"')+";\n"}else{"";setObject+=before+"	"+thisObj+"."+atrName+" = "+(this.isNumberOrBoolean(atrValue)?atrValue:'"'+atrValue+'"')+";\n"}}}if(xml.list.length){var itemClassName;for(i=0;i<xml.list.length;i++){var item=xml.list[i];var childName=item.name;var childNameNS=childName.split(":")[0];childName=childName.split(":")[1];var childClass=null;if(childNameNS=="f"&&childName=="script"){continue}else if(item.value!=null&&item.value!=""){setObject+=before+"	"+thisObj+"."+childName+' = "'+flower.StringDo.changeStringToInner(item.value)+'";\n';continue}else if(childNameNS!="f"){if(!namespaces[childNameNS]){sys.$warn(3004,childNameNS,this.parseContent)}childNameNS=this.namespaces[childNameNS];if(this.classes[childNameNS][childName]){childClass=childName}else{if(this.classes[childNameNS+"Content"][childName]){this.parse(this.classes[childNameNS+"Content"][childName]);childClass=this.classes[childNameNS][childName]}else{sys.$warn(3005,childName,this.parseContent)}}}else{if(this.classes[childNameNS]){childClass=this.classes[childNameNS][childName]}else{sys.$warn(3004,childNameNS,this.parseContent)}}if(childClass==null){item=item.list[0]}itemClassName=item.name.split(":")[1];if(!nameIndex[itemClassName]){nameIndex[itemClassName]=1}else{nameIndex[itemClassName]++;itemClassName+=nameIndex[itemClassName]}if(childClass==null){if(childName=="itemRenderer"){for(var n=0;n<this.rootXML.namespaces.length;n++){item.addNameSpace(this.rootXML.namespaces[n])}var itemRenderer=new UIParser;itemRenderer.loadURL=this.loadURL;itemRenderer.namespaces=this.namespaces;setObject+=before+"	"+thisObj+"."+childName+' = flower.UIParser.getLocalUIClass("'+itemRenderer.parse(item)+'","'+itemRenderer.moduleName+'");\n'}else{funcName=className+"_get"+itemClassName;setObject+=before+"	"+thisObj+"."+childName+" = this."+funcName+"("+thisObj+");\n";this.decodeObject(before,className,funcName,true,item,namespaces,propertyFunc,nameIndex)}}else{funcName=className+"_get"+itemClassName;setObject+=before+"	"+thisObj+"."+(UIParser.classes.addChild[createClassName]?UIParser.classes.addChild[createClassName]:"addChild")+"(this."+funcName+"("+thisObj+"));\n";this.decodeObject(before,className,funcName,true,item,namespaces,propertyFunc,nameIndex)}}}if(createClass){setObject+=before+"	return "+thisObj+";\n"}setObject+=before+"}\n\n";propertyFunc.push(setObject)}},{key:"isNumberOrBoolean",value:function isNumberOrBoolean(str){if(str=="true"||str=="false"){return true}if(str.length>3&&(str.slice(0,2)=="0x"||str.slice(0,2)=="0X")){for(var i=2;i<str.length;i++){var code=str.charCodeAt(i);if(code>=48&&code<=57||code>=65&&code<=70||code>=97&&code<=102){}else{return false}}}else{if(!str.length){return false}for(var i=0;i<str.length;i++){var code=str.charCodeAt(i);if(code>=48&&code<=57){}else{return false}}}return true}},{key:"className",get:function get(){return this._className}},{key:"classDefine",get:function get(){return this.classes[this._classNameSpace][this._className]}}],[{key:"registerLocalUIClass",value:function registerLocalUIClass(name,cls){var moduleName=arguments.length<=2||arguments[2]===undefined?"local":arguments[2];flower.UIParser.classes[moduleName][name]=cls}},{key:"setLocalUIClassContent",value:function setLocalUIClassContent(name,content){var moduleName=arguments.length<=2||arguments[2]===undefined?"local":arguments[2];flower.UIParser.classes[moduleName+"Content"][name]=content}},{key:"getLocalUIClassContent",value:function getLocalUIClassContent(name){var moduleName=arguments.length<=1||arguments[1]===undefined?"local":arguments[1];return flower.UIParser.classes[moduleName+"Content"]?flower.UIParser.classes[moduleName+"Content"][name]:null}},{key:"getLocalUIClass",value:function getLocalUIClass(name){var moduleName=arguments.length<=1||arguments[1]===undefined?"local":arguments[1];return this.classes[moduleName]?this.classes[moduleName][name]:null}},{key:"setLocalUIURL",value:function setLocalUIURL(name,url){var moduleName=arguments.length<=2||arguments[2]===undefined?"local":arguments[2];this.classes[moduleName+"URL"][name]=url;this.classes.uiModule[url]=moduleName;this.classes.defaultClassNames[url]=name}},{key:"addModule",value:function addModule(moduleName,url){var packageURL=moduleName;if(!flower.UIParser.classes[moduleName]){var pkgs=packageURL.split(".");if(pkgs[0]==""){pkgs=[]}flower.UIParser.classes.namespaces[url]=moduleName;flower.UIParser.classes.packages[moduleName]=pkgs;flower.UIParser.classes[moduleName]={};flower.UIParser.classes[moduleName+"Content"]={};flower.UIParser.classes[moduleName+"URL"]={}}}},{key:"setModuleBeforeScript",value:function setModuleBeforeScript(moduleName,beforeScript){flower.UIParser.classes.beforeScripts[moduleName]=beforeScript}}]);return UIParser}(Group);UIParser.classes={f:{Object:"Object",Array:"Array",Point:"flower.Point",Size:"flower.Size",Rectangle:"flower.Rectangle",ColorFilter:"flower.ColorFilter",TextField:"flower.TextField",TextInput:"flower.TextInput",Bitmap:"flower.Bitmap",Shape:"flower.Shape",Mask:"flower.Mask",ArrayValue:"flower.ArrayValue",BooleanValue:"flower.BooleanValue",IntValue:"flower.IntValue",NumberValue:"flower.NumberValue",ObjectValue:"flower.ObjectValue",StringValue:"flower.StringValue",UIntValue:"flower.UIntValue",Label:"flower.Label",Input:"flower.Input",Image:"flower.Image",Group:"flower.Group",ScrollBar:"flower.ScrollBar",HScrollBar:"flower.HScrollBar",VScrollBar:"flower.VScrollBar",Button:"flower.Button",Rect:"flower.Rect",MaskUI:"flower.MaskUI",Scroller:"flower.Scroller",DataGroup:"flower.DataGroup",ItemRenderer:"flower.ItemRenderer",ToggleButton:"flower.ToggleButton",ToggleSwitch:"flower.ToggleSwitch",CheckBox:"flower.CheckBox",RadioButton:"flower.RadioButton",RadioButtonGroup:"flower.RadioButtonGroup",ListBase:"flower.ListBase",List:"flower.List",TabBar:"flower.TabBar",ViewStack:"flower.ViewStack",ComboBox:"flower.ComboBox",Panel:"flower.Panel",Alert:"flower.Alert",Tree:"flower.Tree",LinearLayoutBase:"flower.LinearLayoutBase",HorizontalLayout:"flower.HorizontalLayout",VerticalLayout:"flower.VerticalLayout",RemoteDirection:"flower.RemoteDirection",RemoteFile:"flower.RemoteFile"},local:{},localContent:{},localURL:{},addChild:{Array:"push",ArrayValue:"push"},uiModule:{},namespaces:{},defaultClassNames:{},packages:{local:""},beforeScripts:{}};black.UIParser=UIParser;var ScrollBar=function(_Group2){_inherits(ScrollBar,_Group2);function ScrollBar(){_classCallCheck(this,ScrollBar);var _this14=_possibleConstructorReturn(this,Object.getPrototypeOf(ScrollBar).call(this));_this14.$ScrollerBar={0:null,1:true,2:null,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,20:null,50:0,51:0};return _this14}_createClass(ScrollBar,[{key:"$onFrameEnd",value:function $onFrameEnd(){var p=this.$ScrollerBar;if(p[0]&&p[20]!=null){var viewport=p[0];if(p[20]){if(p[3]!=viewport.x||p[5]!=viewport.scrollH||p[7]!=viewport.contentWidth||p[9]!=viewport.width){p[3]=viewport.x;p[5]=viewport.scrollH;p[7]=viewport.contentWidth;p[9]=viewport.width;if(p[2]){if(p[7]<p[9]){p[2].width=this.width;p[2].x=0}else{p[2].width=this.width*p[9]/p[7];var x=-(this.width-p[2].width)*(p[3]-p[5])/(p[7]-p[9]);if(x<0){x=0}if(x+p[2].width>this.width){x=this.width-p[2].width}p[2].x=x}}}}if(!p[20]){if(p[4]!=viewport.y||p[6]!=viewport.scrollH||p[8]!=viewport.contentHeight||p[10]!=viewport.height){p[4]=viewport.y;p[6]=viewport.scrollH;p[8]=viewport.contentHeight;p[10]=viewport.height;if(p[2]){if(p[8]<p[10]){p[2].height=this.height;p[2].y=0}else{p[2].height=this.height*p[10]/p[8];var y=-(this.height-p[2].height)*(p[4]-p[6])/(p[8]-p[10]);if(y<0){y=0}if(y+p[2].height>this.height){y=this.height-p[2].height}p[2].y=y}}}}}_get(Object.getPrototypeOf(ScrollBar.prototype),"$onFrameEnd",this).call(this)}},{key:"__onTouchThumb",value:function __onTouchThumb(e){var p=this.$ScrollerBar;switch(e.type){case flower.TouchEvent.TOUCH_BEGIN:if(p[20]){p[50]=e.stageX;p[51]=p[2].x}else{p[50]=e.stageY;p[51]=p[2].y}break;case flower.TouchEvent.TOUCH_MOVE:if(p[20]){if(p[7]<p[9]){return}var x=p[51]-p[50]+e.stageX;if(x<0){x=0}if(x+p[2].width>this.width){x=this.width-p[2].width}if(p[0]){p[0].x=-x*(p[7]-p[9])/(this.width-p[2].width)+p[5]}}else{if(p[8]<p[10]){return}var y=p[51]-p[50]+e.stageY;if(y<0){y=0}if(y+p[2].height>this.height){y=this.height-p[2].height}if(p[0]){p[0].y=-y*(p[8]-p[10])/(this.height-p[2].height)+p[6]}}break}}},{key:"viewport",set:function set(val){var p=this.$ScrollerBar;if(p[0]==val){return}p[0]=val},get:function get(){return this.$ScrollerBar[0]}},{key:"thumb",set:function set(val){var p=this.$ScrollerBar;if(p[2]==val){return}if(p[2]){p[2].removeListener(flower.TouchEvent.TOUCH_BEGIN,this.__onTouchThumb,this);p[2].removeListener(flower.TouchEvent.TOUCH_MOVE,this.__onTouchThumb,this)}p[2]=val;if(p[2]){if(p[2].parent!=this){this.addChild(p[2])}p[2].addListener(flower.TouchEvent.TOUCH_BEGIN,this.__onTouchThumb,this);p[2].addListener(flower.TouchEvent.TOUCH_MOVE,this.__onTouchThumb,this)}},get:function get(){return this.$ScrollerBar[2]}},{key:"autoVisibility",set:function set(val){if(val=="false"){val=false}val=!!val;this.$ScrollerBar[1]=val},get:function get(){return this.$ScrollerBar[1]}}]);return ScrollBar}(Group);black.ScrollBar=ScrollBar;var VScrollBar=function(_ScrollBar){_inherits(VScrollBar,_ScrollBar);function VScrollBar(){_classCallCheck(this,VScrollBar);var _this15=_possibleConstructorReturn(this,Object.getPrototypeOf(VScrollBar).call(this));_this15.$ScrollerBar[20]=false;return _this15}return VScrollBar}(ScrollBar);black.VScrollBar=VScrollBar;var HScrollBar=function(_ScrollBar2){_inherits(HScrollBar,_ScrollBar2);function HScrollBar(){_classCallCheck(this,HScrollBar);var _this16=_possibleConstructorReturn(this,Object.getPrototypeOf(HScrollBar).call(this));_this16.$ScrollerBar[20]=true;return _this16}return HScrollBar}(ScrollBar);black.HScrollBar=HScrollBar;var DataGroup=function(_Group3){_inherits(DataGroup,_Group3);function DataGroup(){_classCallCheck(this,DataGroup);var _this17=_possibleConstructorReturn(this,Object.getPrototypeOf(DataGroup).call(this));_this17.$DataGroup={0:null,1:null,2:null,3:null,4:0,5:0,6:0,7:0,8:null,9:null,10:false,11:true,12:false,13:flower.TouchEvent.TOUCH_BEGIN,14:100,15:0,16:null};_this17.addListener(flower.TouchEvent.TOUCH_RELEASE,_this17.__onTouchItem,_this17);return _this17}_createClass(DataGroup,[{key:"__onDataUpdate",value:function __onDataUpdate(){this.$addFlags(16384);var p=this.$DataGroup;if(p[10]&&p[0].length&&this.selectedItem==null){this.__setSelectedItemData(p[0].getItemAt(0))}}},{key:"$resetLayout",value:function $resetLayout(){if(this.$hasFlags(8192)){this.$removeFlags(8192);if(this.layout&&(!this.$DataGroup[3]||!this.layout.fixElementSize)){this.layout.updateList(this.width,this.height)}}}},{key:"$addFlags",value:function $addFlags(flags){if((flags&1)==1){if((this.__flags&4096)!=4096&&(!this.parent||!this.parent.__UIComponent)){this.__flags|=4096}if(this.layout){this.__flags|=8192}}if((flags&4)==4){this.__flags|=16384}this.__flags|=flags}},{key:"$onFrameEnd",value:function $onFrameEnd(){var p=this.$DataGroup;if(p[3]){if(p[4]!=p[3].width||p[5]!=p[3].height){p[4]=p[3].width;p[5]=p[3].height;this.$addFlags(16384)}}if(p[0]&&p[1]&&this.$hasFlags(16384)){this.$removeFlags(16384);if(!p[2]){p[2]=[]}var items=p[2];var list=p[0];var newItems=[];var item;var itemData;var measureSize=false;var findSelected=false;var layout=this.layout;if(!p[3]||!layout||!layout.fixElementSize){for(var i=0,len=list.length;i<len;i++){item=null;itemData=list.getItemAt(i);for(var f=0;f<items.length;f++){if(items[f].data==itemData){item=items[f];items.splice(f,1);break}}if(item==null){
item=this.createItem(itemData,i);item.data=itemData}if(item.parent==this){this.setChildIndex(item,i)}else{this.addChild(item)}item.$setItemIndex(i);newItems[i]=item}}else{layout.$clear();var elementWidth=p[6];var elementHeight=p[7];if(p[0].length&&(!elementWidth||!elementHeight)){if(!items.length){item=this.createItem(list.getItemAt(0),0);item.data=list.getItemAt(0);items.push(item)}if(!elementWidth){p[6]=elementWidth=items[0].width}if(!elementHeight){p[7]=elementHeight=items[0].height}}var firstItemIndex=layout.getFirstItemIndex(elementWidth,elementHeight,-this.x,-this.y);firstItemIndex=firstItemIndex<0?0:firstItemIndex;for(var i=firstItemIndex;i<list.length;i++){item=null;itemData=list.getItemAt(i);for(var f=0;f<items.length;f++){if(items[f].data==itemData){item=items[f];items.splice(f,1);break}}if(!item){item=this.createItem(itemData,i);item.data=itemData}if(item.parent==this){this.setChildIndex(item,i-firstItemIndex)}else{this.addChild(item)}item.$setItemIndex(i);newItems[i-firstItemIndex]=item;layout.updateList(p[4],p[5],firstItemIndex,p[6],p[7]);if(layout.isElementsOutSize(-this.x,-this.y,p[4],p[5])){break}}}if(p[9]){findSelected=false;for(var i=0,len=list.length;i<len;i++){if(list.getItemAt(i)==p[9]){findSelected=true;break}}if(!findSelected){p[9]=null}}measureSize=true;while(items.length){items.pop().dispose()}p[2]=newItems;if(!p[9]){this._canSelecteItem()}}_get(Object.getPrototypeOf(DataGroup.prototype),"$onFrameEnd",this).call(this);if(measureSize){if(layout){if(!p[3]||!layout.fixElementSize){var size=layout.getContentSize();p[52]=size.width;p[53]=size.height;flower.Size.release(size)}else if(p[2].length){var size=layout.measureSize(p[6],p[7],list.length);p[52]=size.width;p[53]=size.height;flower.Size.release(size)}}}}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){_get(Object.getPrototypeOf(DataGroup.prototype),"$validateUIComponent",this).call(this,parent);this.$IViewPort[0]=0;this.$IViewPort[1]=0;this.$IViewPort[2]=this.$DataGroup[52];this.$IViewPort[3]=this.$DataGroup[53]}},{key:"createItem",value:function createItem(data,index){var p=this.$DataGroup;var item=new p[1](data);item.index=index;item.$setList(p[0]);item.addListener(flower.TouchEvent.TOUCH_BEGIN,this.__onTouchItem,this);item.addListener(flower.TouchEvent.TOUCH_END,this.__onTouchItem,this);item.addListener(flower.TouchEvent.TOUCH_RELEASE,this.__onTouchItem,this);item.addListener(flower.MouseEvent.MOUSE_OVER,this.__onMouseItem,this);item.addListener(flower.MouseEvent.MOUSE_OUT,this.__onMouseItem,this);if(item.data==p[8]){if(item.data==p[9]){item.currentState="selectedDown";item.selected=true}else{item.currentState="down"}}else{if(item.data==p[9]){item.currentState="selectedUp";item.selected=true}else{item.currentState="up"}}return item}},{key:"__onMouseItem",value:function __onMouseItem(e){var p=this.$DataGroup;var item=e.currentTarget;if(item.currentState=="up"||item.currentState=="over"){switch(e.type){case flower.MouseEvent.MOUSE_OVER:item.currentState="over";break;case flower.MouseEvent.MOUSE_OUT:if(item.data==p[9]){item.currentState="selectedUp";item.selected=true}else{item.currentState="up"}break}}}},{key:"__onTouchItem",value:function __onTouchItem(e){var p=this.$DataGroup;var item=e.currentTarget;switch(e.type){case flower.TouchEvent.TOUCH_BEGIN:this.dispatchWith(flower.Event.TOUCH_BEGIN_ITEM,item.data,true);if(p[13]==flower.TouchEvent.TOUCH_BEGIN||p[9]==item.data){p[15]=-1;if(p[10]){p[8]=item.data;item.currentState="down"}this.__setSelectedItemData(p[8]);if(p[13]==flower.TouchEvent.TOUCH_BEGIN){if(p[11]){item.$onClick();this.dispatchWith(flower.Event.CLICK_ITEM,item.data,true)}}}else{p[15]=flower.CoreTime.currentTime;p[16]=item.data;if(p[10]){p[8]=p[16]}flower.EnterFrame.add(this.__onTouchUpdate,this)}break;case flower.TouchEvent.TOUCH_RELEASE:flower.EnterFrame.remove(this.__onTouchUpdate,this);this.$releaseItem();break;case flower.TouchEvent.TOUCH_END:flower.EnterFrame.remove(this.__onTouchUpdate,this);if(p[8]==item.data){this.$releaseItem();p[8]=null;if(p[13]==flower.TouchEvent.TOUCH_END){this.__setSelectedItemData(item.data)}if(p[11]){item.$onClick();this.dispatchWith(flower.Event.CLICK_ITEM,item.data,true)}}else{this.$releaseItem()}break}}},{key:"__onTouchUpdate",value:function __onTouchUpdate(timeStamp,gap){var p=this.$DataGroup;if(timeStamp>p[15]+p[14]){flower.EnterFrame.remove(this.__onTouchUpdate,this);var item=this.getItemByData(p[8]);if(item){item.currentState="down"}if(p[13]==flower.TouchEvent.TOUCH_BEGIN||p[9]==p[8]){this.__setSelectedItemData(p[8])}}}},{key:"$releaseItem",value:function $releaseItem(){var p=this.$DataGroup;var clickItem=this.getItemByData(p[8]);if(clickItem){if(p[8]==p[9]){clickItem.currentState="selectedUp"}else{clickItem.currentState="up"}}p[8]=null}},{key:"_canSelecteItem",value:function _canSelecteItem(){var p=this.$DataGroup;if(p[12]&&p[10]&&!p[9]&&p[0]&&p[0].length){this.__setSelectedItemData(p[0].getItemAt(0))}}},{key:"__setSelectedItemData",value:function __setSelectedItemData(itemData){var p=this.$DataGroup;var selectedItem=p[9];var changeFlag=true;if(itemData==selectedItem||!p[10]){changeFlag=false}var data=p[0];var find=false;for(var i=0,len=data.length;i<data.length;i++){if(data.getItemAt(i)==itemData){find=true;break}}if(!find){itemData=null}var itemRenderer;if(selectedItem){itemRenderer=this.getItemByData(selectedItem);if(itemRenderer){if(itemRenderer.data==p[8]){itemRenderer.currentState="down"}else{itemRenderer.currentState="up"}itemRenderer.selected=false}}selectedItem=p[9]=itemData;itemRenderer=this.getItemByData(selectedItem);if(itemRenderer){if(itemRenderer.data==p[8]){itemRenderer.currentState="selectedDown"}else{itemRenderer.currentState="selectedUp"}itemRenderer.selected=true}if(changeFlag){this.dispatchWith(flower.Event.SELECTED_ITEM_CHANGE,itemData,true)}if(!selectedItem){this._canSelecteItem()}}},{key:"onScroll",value:function onScroll(){this.$addFlag(1024)}},{key:"getItemByData",value:function getItemByData(data){var items=this.$DataGroup[2];if(!items){return null}for(var i=0,len=items.length;i<len;i++){if(items[i].data==data){return items[i]}}return null}},{key:"getItemDataIndex",value:function getItemDataIndex(data){var p=this.$DataGroup;for(var i=0,i=p[0].length;i<len;i++){if(p[0].getItemAt(i)==data){return i}}return-1}},{key:"$getDataProvider",value:function $getDataProvider(){return this.$DataGroup[0]}},{key:"$setDataProvider",value:function $setDataProvider(val){var p=this.$DataGroup;if(p[0]==val){return false}if(p[0]){p[0].removeListener(flower.Event.CHANGE,this.__onDataUpdate,this)}this.removeAll();p[2]=null;p[0]=val;this.$addFlags(16384);if(p[0]){if(!p[9]){this._canSelecteItem()}p[0].addListener(flower.Event.CHANGE,this.__onDataUpdate,this)}this.selectedItem=null;if(p[10]&&p[0].length){this.__setSelectedItemData(p[0].getItemAt(0))}return true}},{key:"dataProvider",get:function get(){return this.$getDataProvider()},set:function set(val){this.$setDataProvider(val)}},{key:"itemRenderer",get:function get(){var p=this.$DataGroup;return p[1]},set:function set(val){if(typeof val=="string"){var clazz=$root[val];if(!clazz){clazz=flower.UIParser.getLocalUIClass(val.split(":")[val.split(":").length-1],val.split(":").length>1?val.split(":")[0]:"");if(!clazz){sys.$error(3201,val)}}val=clazz}var p=this.$DataGroup;if(p[1]==val){return}this.removeAll();p[2]=null;p[1]=val;p[6]=p[7]=0;this.$addFlags(16384)}},{key:"numElements",get:function get(){return this.$DataGroup[2].length}},{key:"viewer",set:function set(display){this.$DataGroup[3]=display},get:function get(){return this.$DataGroup[3]}},{key:"scrollEnabled",get:function get(){return true}},{key:"selectedIndex",get:function get(){return this.getItemDataIndex(this.$DataGroup[9])},set:function set(val){var p=this.$DataGroup;val=+val||0;var item;if(p[0]==null){sys.$error(3102)}if(val!=-1){if(val<0||val>=p[0].length){sys.$error(3101,val,p[0].length)}item=p[0][val];if(p[9]&&p[9].itemIndex==val){return}}this.__setSelectedItemData(item)}},{key:"selectedItem",get:function get(){return this.$DataGroup[9]},set:function set(val){var p=this.$DataGroup;if(p[9]==val){return}if(p[0]==null){sys.$error(3102)}var p=this.$DataGroup;if(p[0].getItemIndex(val)==-1){this.__setSelectedItemData(null)}else{this.__setSelectedItemData(val)}}},{key:"itemSelectedEnabled",get:function get(){return this.$DataGroup[10]},set:function set(val){if(val=="false"){val=false}if(this.$DataGroup[10]==val){return}this.$DataGroup[10]=!!val;this._canSelecteItem()}},{key:"itemClickedEnabled",get:function get(){return this.$DataGroup[11]},set:function set(val){if(val=="false"){val=false}val=!!val;if(this.$DataGroup[11]==val){return}this.$DataGroup[11]=val}},{key:"requireSelection",get:function get(){return this.$DataGroup[12]},set:function set(val){if(val=="false"){val=false}val=!!val;if(val==this.$DataGroup[12]){return}this.$DataGroup[12]=val;if(val){this._canSelecteItem()}}},{key:"selectTime",get:function get(){return this.$DataGroup[13]},set:function set(val){if(val!=flower.TouchEvent.TOUCH_BEGIN&&val!=flower.TouchEvent.TOUCH_END){sys.$error(1008,val,"DataGroup","selectTime");return}this.$DataGroup[13]=val}},{key:"validDownStateTime",get:function get(){return this.$DataGroup[14]},set:function set(val){this.$DataGroup[14]=+val*1e3||0}}]);return DataGroup}(Group);UIComponent.registerEvent(DataGroup,1110,"clickItem",flower.Event.CLICK_ITEM);UIComponent.registerEvent(DataGroup,1111,"selectedItemChange",flower.Event.SELECTED_ITEM_CHANGE);UIComponent.registerEvent(DataGroup,1112,"touchBeginItem",flower.Event.TOUCH_BEGIN_ITEM);black.DataGroup=DataGroup;var ItemRenderer=function(_Group4){_inherits(ItemRenderer,_Group4);function ItemRenderer(){_classCallCheck(this,ItemRenderer);var _this18=_possibleConstructorReturn(this,Object.getPrototypeOf(ItemRenderer).call(this));_this18._selected=false;_this18.absoluteState=true;return _this18}_createClass(ItemRenderer,[{key:"$setItemIndex",value:function $setItemIndex(val){this._itemIndex=val}},{key:"setSelected",value:function setSelected(val){this._selected=val;if(this._selected){if(this.onSelectedEXE){this.onSelectedEXE.call(this)}}}},{key:"$onClick",value:function $onClick(){if(this.onClickEXE){this.onClickEXE.call(this)}}},{key:"$setList",value:function $setList(val){this._list=val}},{key:"itemIndex",get:function get(){return this._itemIndex}},{key:"selected",get:function get(){return this._selected},set:function set(val){if(val=="false"){val=false}val=!!val;if(this._selected==val){return}this.setSelected(val)}},{key:"onClick",set:function set(val){if(typeof val=="string"){var content=val;val=function(){eval(content)}.bind(this.eventThis)}this.onClickEXE=val},get:function get(){return this.onClickEXE}},{key:"onSelected",set:function set(val){if(typeof val=="string"){var content=val;val=function(){eval(content)}.bind(this.eventThis)}this.onSelectedEXE=val},get:function get(){return this.onClickEXE}},{key:"list",get:function get(){return this._list}}]);return ItemRenderer}(Group);black.ItemRenderer=ItemRenderer;var Label=function(_flower$TextField){_inherits(Label,_flower$TextField);function Label(){var text=arguments.length<=0||arguments[0]===undefined?"":arguments[0];_classCallCheck(this,Label);var _this19=_possibleConstructorReturn(this,Object.getPrototypeOf(Label).call(this,text));_this19.$initUIComponent();_this19.selectable=false;return _this19}_createClass(Label,[{key:"$addFlags",value:function $addFlags(flags){if((flags&1)==1&&(this.__flags&4096)!=4096&&(!this.parent||!this.parent.__UIComponent)){this.__flags|=4096}this.__flags|=flags}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){this.$removeFlags(4096);var p=this.$UIComponent;if(this.$hasFlags(1)){this.$getContentBounds()}parent=parent||this.parent;if(p[0]!=null&&p[1]==null&&p[2]!=null){this.width=(p[2]-p[0])*2;this.x=p[0]}else if(p[0]==null&&p[1]!=null&&p[2]!=null){this.width=(p[1]-p[2])*2;this.x=2*p[2]-p[1]}else if(p[0]!=null&&p[1]!=null){this.width=parent.width-p[1]-p[0];this.x=p[0]}else{if(p[0]!=null){this.x=p[0]}if(p[1]!=null){this.x=parent.width-p[1]-this.width*this.scaleX}if(p[2]!=null){this.x=(parent.width-this.width*this.scaleX)*.5+p[2]}if(p[6]){this.width=parent.width*p[6]/100}}if(p[3]!=null&&p[4]==null&&p[5]!=null){this.height=(p[5]-p[3])*2;this.y=p[3]}else if(p[3]==null&&p[4]!=null&&p[5]!=null){this.height=(p[4]-p[5])*2;this.y=2*p[5]-p[4]}else if(p[3]!=null&&p[4]!=null){this.height=parent.height-p[4]-p[3];this.y=p[3]}else{if(p[3]!=null){this.y=p[3]}if(p[4]!=null){this.y=parent.height-p[4]-this.height*this.scaleY}if(p[5]!=null){this.y=(parent.height-this.height*this.scaleY)*.5+p[5]}if(p[7]){this.height=parent.height*p[7]/100}}}},{key:"$onFrameEnd",value:function $onFrameEnd(){if(this.$hasFlags(4096)&&!this.parent.__UIComponent){this.$validateUIComponent()}_get(Object.getPrototypeOf(Label.prototype),"$onFrameEnd",this).call(this);if(this.$hasFlags(2048)){this.$getContentBounds();_get(Object.getPrototypeOf(Label.prototype),"$onFrameEnd",this).call(this)}flower.DebugInfo.frameInfo.display++;flower.DebugInfo.frameInfo.text++;var p=this.$DisplayObject;if(this.$hasFlags(2)){this.$nativeShow.setAlpha(this.$getConcatAlpha())}}},{key:"dispose",value:function dispose(){this.removeAllBindProperty();this.$UIComponent[11].dispose();_get(Object.getPrototypeOf(Label.prototype),"dispose",this).call(this)}}]);return Label}(flower.TextField);UIComponent.register(Label);Label.prototype.__UIComponent=true;black.Label=Label;var Input=function(_flower$TextField2){_inherits(Input,_flower$TextField2);function Input(){var text=arguments.length<=0||arguments[0]===undefined?"":arguments[0];_classCallCheck(this,Input);var _this20=_possibleConstructorReturn(this,Object.getPrototypeOf(Input).call(this,text));_this20.$initUIComponent();_this20.$input={0:null};_this20.$IViewPort={0:0,1:0,2:0,3:0,4:null,5:null,6:null};_this20.input=true;_this20.addListener(flower.Event.STOP_INPUT,_this20.__onTextChange,_this20);return _this20}_createClass(Input,[{key:"$addFlags",value:function $addFlags(flags){if((flags&1)==1&&(this.__flags&4096)!=4096&&(!this.parent||!this.parent.__UIComponent)){this.__flags|=4096}this.__flags|=flags}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){this.$removeFlags(4096);var p=this.$UIComponent;if(this.$hasFlags(1)){this.$getContentBounds()}parent=parent||this.parent;if(p[0]!=null&&p[1]==null&&p[2]!=null){this.width=(p[2]-p[0])*2;this.x=p[0]}else if(p[0]==null&&p[1]!=null&&p[2]!=null){this.width=(p[1]-p[2])*2;this.x=2*p[2]-p[1]}else if(p[0]!=null&&p[1]!=null){this.width=parent.width-p[1]-p[0];this.x=p[0]}else{if(p[0]!=null){this.x=p[0]}if(p[1]!=null){this.x=parent.width-p[1]-this.width*this.scaleX}if(p[2]!=null){this.x=(parent.width-this.width*this.scaleX)*.5+p[2]}if(p[6]){this.width=parent.width*p[6]/100}}if(p[3]!=null&&p[4]==null&&p[5]!=null){this.height=(p[5]-p[3])*2;this.y=p[3]}else if(p[3]==null&&p[4]!=null&&p[5]!=null){this.height=(p[4]-p[5])*2;this.y=2*p[5]-p[4]}else if(p[3]!=null&&p[4]!=null){this.height=parent.height-p[4]-p[3];this.y=p[3]}else{if(p[3]!=null){this.y=p[3]}if(p[4]!=null){this.y=parent.height-p[4]-this.height*this.scaleY}if(p[5]!=null){this.y=(parent.height-this.height*this.scaleY)*.5+p[5]}if(p[7]){this.height=parent.height*p[7]/100}}}},{key:"__onTextChange",value:function __onTextChange(e){if(this.$input[0]&&this.$input[0]instanceof flower.Value){this.$input[0].value=this.text;if(this.text!=this.$input[0].value+""){this.__valueChange()}}}},{key:"__valueChange",value:function __valueChange(){if(this.$input[0]!=null){this.text=this.$input[0]instanceof flower.Value?this.$input[0].value:this.$input[0]}}},{key:"__onValueChange",value:function __onValueChange(e){this.__valueChange()}},{key:"$setHtmlText",value:function $setHtmlText(text){_get(Object.getPrototypeOf(Input.prototype),"$setHtmlText",this).call(this,text);var p=this.$TextField;this.$IViewPort[2]=p[17];this.$IViewPort[3]=p[18]}},{key:"dispose",value:function dispose(){if(this.$input[0]&&this.$input[0]instanceof flower.Value){this.$input[0].removeListener(flower.Event.CHANGE,this.__onValueChange,this)}this.removeAllBindProperty();this.$UIComponent[11].dispose();_get(Object.getPrototypeOf(Input.prototype),"dispose",this).call(this)}},{key:"$getX",value:function $getX(){var p=this.$TextField;if(this.$IViewPort[6]){return p[50]}else{return _get(Object.getPrototypeOf(Input.prototype),"$getX",this).call(this)}}},{key:"$setX",value:function $setX(val){val=+val||0;var p=this.$TextField;if(this.$IViewPort[6]){if(p[50]==val){return}p[50]=val;p[100]=true}else{_get(Object.getPrototypeOf(Input.prototype),"$setX",this).call(this,val)}}},{key:"$getY",value:function $getY(){var p=this.$TextField;if(this.$IViewPort[6]){return p[51]}else{return _get(Object.getPrototypeOf(Input.prototype),"$getY",this).call(this)}}},{key:"$setY",value:function $setY(val){val=+val||0;var p=this.$TextField;if(this.$IViewPort[6]){if(p[51]==val){return}p[51]=val;p[100]=true}else{_get(Object.getPrototypeOf(Input.prototype),"$setY",this).call(this,val)}}},{key:"$getContentWidth",value:function $getContentWidth(){return this.$IViewPort[2]-this.$IViewPort[0]}},{key:"$getContentHeight",value:function $getContentHeight(){return this.$IViewPort[3]-this.$IViewPort[1]}},{key:"viewer",set:function set(val){if(this.$IViewPort[6]==val){return}this.$IViewPort[6]=val;var p=this.$TextField;p[100]=true}},{key:"value",set:function set(val){if(this.$input[0]==val){return}if(this.$input[0]&&this.$input[0]instanceof flower.Value){this.$input[0].removeListener(flower.Event.CHANGE,this.__onValueChange,this)}this.$input[0]=val;if(this.$input[0]&&this.$input[0]instanceof flower.Value){this.$input[0].addListener(flower.Event.CHANGE,this.__onValueChange,this)}this.__valueChange()},get:function get(){return this.$input[0]}},{key:"contentWidth",get:function get(){return this.$getContentWidth()}},{key:"contentHeight",get:function get(){return this.$getContentHeight()}},{key:"scrollH",get:function get(){return this.$IViewPort[4]==null?this.$IViewPort[0]:this.$IViewPort[4]},set:function set(val){if(val!=null){val=+val}if(this.$IViewPort[4]==val){return}this.$IViewPort[4]=val}},{key:"scrollV",get:function get(){return this.$IViewPort[5]==null?this.$IViewPort[1]:this.$IViewPort[5]},set:function set(val){if(val!=null){val=+val}if(this.$IViewPort[5]==val){return}this.$IViewPort[5]=val;var p=this.$TextField;p[51]=val;p[100]=true}}]);return Input}(flower.TextField);UIComponent.register(Input);Input.prototype.__UIComponent=true;black.Input=Input;UIComponent.registerEvent(Input,1140,"startInput",flower.Event.START_INPUT);UIComponent.registerEvent(Input,1141,"stopInput",flower.Event.STOP_INPUT);var Rect=function(_flower$Shape){_inherits(Rect,_flower$Shape);function Rect(){_classCallCheck(this,Rect);var _this21=_possibleConstructorReturn(this,Object.getPrototypeOf(Rect).call(this));_this21.$Rect={0:0,1:0};_this21.$initUIComponent();return _this21}_createClass(Rect,[{key:"$addFlags",value:function $addFlags(flags){if((flags&1)==1&&(this.__flags&4096)!=4096&&(!this.parent||!this.parent.__UIComponent)){this.__flags|=4096}if(flags==2){this.__flags|=1024}this.__flags|=flags}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){this.$removeFlags(4096);var p=this.$UIComponent;if(this.$hasFlags(1)){this.$getContentBounds()}parent=parent||this.parent;if(p[0]!=null&&p[1]==null&&p[2]!=null){this.width=(p[2]-p[0])*2;this.x=p[0]}else if(p[0]==null&&p[1]!=null&&p[2]!=null){this.width=(p[1]-p[2])*2;this.x=2*p[2]-p[1]}else if(p[0]!=null&&p[1]!=null){this.width=parent.width-p[1]-p[0];this.x=p[0]}else{if(p[0]!=null){this.x=p[0]}if(p[1]!=null){this.x=parent.width-p[1]-this.width*this.scaleX}if(p[2]!=null){this.x=(parent.width-this.width*this.scaleX)*.5+p[2]}if(p[6]){this.width=parent.width*p[6]/100}}if(p[3]!=null&&p[4]==null&&p[5]!=null){this.height=(p[5]-p[3])*2;this.y=p[3]}else if(p[3]==null&&p[4]!=null&&p[5]!=null){this.height=(p[4]-p[5])*2;this.y=2*p[5]-p[4]}else if(p[3]!=null&&p[4]!=null){this.height=parent.height-p[4]-p[3];this.y=p[3]}else{if(p[3]!=null){this.y=p[3]}if(p[4]!=null){this.y=parent.height-p[4]-this.height*this.scaleY}if(p[5]!=null){this.y=(parent.height-this.height*this.scaleY)*.5+p[5]}if(p[7]){this.height=parent.height*p[7]/100}}}},{key:"$setFillColor",value:function $setFillColor(val){if(_get(Object.getPrototypeOf(Rect.prototype),"$setFillColor",this).call(this,val)){this.$resetRect()}}},{key:"$setFillAlpha",value:function $setFillAlpha(val){if(_get(Object.getPrototypeOf(Rect.prototype),"$setFillAlpha",this).call(this,val)){this.$resetRect()}}},{key:"$setLineWidth",value:function $setLineWidth(val){if(_get(Object.getPrototypeOf(Rect.prototype),"$setLineWidth",this).call(this,val)){this.$resetRect()}}},{key:"$setLineColor",value:function $setLineColor(val){if(_get(Object.getPrototypeOf(Rect.prototype),"$setLineColor",this).call(this,val)){this.$resetRect()}}},{key:"$setLineAlpha",value:function $setLineAlpha(val){if(_get(Object.getPrototypeOf(Rect.prototype),"$setLineAlpha",this).call(this,val)){this.$resetRect()}}},{key:"$setWidth",value:function $setWidth(val){val=+val||0;var p=this.$Rect;if(p[0]==val){return}p[0]=val;this.$resetRect()}},{key:"$resetRect",value:function $resetRect(){var p=this.$Shape;if(p[9].length==0){p[9].push({})}var width=this.$Rect[0];var height=this.$Rect[1];var x=0;var y=0;p[9][0]={points:[{x:x,y:y},{x:x+width,y:y},{x:x+width,y:y+height},{x:x,y:y+height},{x:x,y:y}],fillColor:p[0],fillAlpha:p[1],lineWidth:p[2],lineColor:p[3],lineAlpha:p[4]};this.$addFlags(1024)}},{key:"$setHeight",value:function $setHeight(val){val=+val||0;var p=this.$Rect;if(p[1]==val){return}p[1]=val;this.$resetRect()}},{key:"$onFrameEnd",value:function $onFrameEnd(){if(this.$hasFlags(4096)&&!this.parent.__UIComponent){this.$validateUIComponent()}this.$redraw();flower.DebugInfo.frameInfo.display++;flower.DebugInfo.frameInfo.shape++;var p=this.$DisplayObject;if(this.$hasFlags(2)){this.$nativeShow.setAlpha(this.$getConcatAlpha())}}},{key:"dispose",value:function dispose(){this.removeAllBindProperty();this.$UIComponent[11].dispose();_get(Object.getPrototypeOf(Rect.prototype),"dispose",this).call(this)}}]);return Rect}(flower.Shape);UIComponent.register(Rect);Rect.prototype.__UIComponent=true;black.Rect=Rect;var Image=function(_flower$Bitmap){_inherits(Image,_flower$Bitmap);function Image(){var source=arguments.length<=0||arguments[0]===undefined?null:arguments[0];_classCallCheck(this,Image);var _this22=_possibleConstructorReturn(this,Object.getPrototypeOf(Image).call(this));_this22.$initUIComponent();_this22.source=source;return _this22}_createClass(Image,[{key:"$addFlags",value:function $addFlags(flags){if((flags&1)==1&&(this.__flags&4096)!=4096&&(!this.parent||!this.parent.__UIComponent)){this.__flags|=4096}this.__flags|=flags}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){this.$removeFlags(4096);var p=this.$UIComponent;if(this.$hasFlags(1)){this.$getContentBounds()}parent=parent||this.parent;if(p[0]!=null&&p[1]==null&&p[2]!=null){this.width=(p[2]-p[0])*2;this.x=p[0]}else if(p[0]==null&&p[1]!=null&&p[2]!=null){this.width=(p[1]-p[2])*2;this.x=2*p[2]-p[1]}else if(p[0]!=null&&p[1]!=null){this.width=parent.width-p[1]-p[0];this.x=p[0]}else{if(p[0]!=null){this.x=p[0]}if(p[1]!=null){this.x=parent.width-p[1]-this.width*this.scaleX}if(p[2]!=null){this.x=(parent.width-this.width*this.scaleX)*.5+p[2]}if(p[6]){this.width=parent.width*p[6]/100}}if(p[3]!=null&&p[4]==null&&p[5]!=null){this.height=(p[5]-p[3])*2;this.y=p[3]}else if(p[3]==null&&p[4]!=null&&p[5]!=null){this.height=(p[4]-p[5])*2;this.y=2*p[5]-p[4]}else if(p[3]!=null&&p[4]!=null){this.height=parent.height-p[4]-p[3];this.y=p[3]}else{if(p[3]!=null){this.y=p[3]}if(p[4]!=null){this.y=parent.height-p[4]-this.height*this.scaleY}if(p[5]!=null){this.y=(parent.height-this.height*this.scaleY)*.5+p[5]}if(p[7]){this.height=parent.height*p[7]/100}}}},{key:"$setSource",value:function $setSource(val){if(this.__source==val){return}this.__source=val;if(val==""||val==null){this.texture=null}else if(val instanceof flower.Texture){this.texture=val}else{if(this.__loader){this.__loader.$useImage();this.__loader.dispose()}if(typeof val=="string"&&val.slice(0,2)=="./"&&this.$filePath){val=flower.Path.joinPath(this.$filePath,val)}this.__loader=new flower.URLLoader(val);this.__loader.load();this.__loader.addListener(flower.Event.COMPLETE,this.__onLoadComplete,this);this.__loader.addListener(flower.Event.ERROR,this.__onLoadError,this)}}},{key:"__onLoadError",value:function __onLoadError(e){this.__loader=null}},{key:"__onLoadComplete",value:function __onLoadComplete(e){this.__loader=null;this.texture=e.data;this.dispatchWith(flower.Event.COMPLETE)}},{key:"dispose",value:function dispose(){if(this.__loader){this.__loader.$useImage();this.__loader.dispose()}this.removeAllBindProperty();this.$UIComponent[11].dispose();_get(Object.getPrototypeOf(Image.prototype),"dispose",this).call(this)}},{key:"source",get:function get(){return this.__source},set:function set(val){this.$setSource(val)}},{key:"isLoading",get:function get(){return this.__loader?true:false}}]);return Image}(flower.Bitmap);UIComponent.register(Image);Image.prototype.__UIComponent=true;black.Image=Image;UIComponent.registerEvent(Image,1300,"loadComplete",flower.Event.COMPLETE);var TileImage=function(_Group5){_inherits(TileImage,_Group5);function TileImage(){_classCallCheck(this,TileImage);return _possibleConstructorReturn(this,Object.getPrototypeOf(TileImage).call(this))}_createClass(TileImage,[{key:"$setSource",value:function $setSource(){}}]);return TileImage}(Group);black.TileImage=Group;var MaskUI=function(_flower$Mask){_inherits(MaskUI,_flower$Mask);function MaskUI(data){_classCallCheck(this,MaskUI);var _this24=_possibleConstructorReturn(this,Object.getPrototypeOf(MaskUI).call(this));if(data!=null){_this24._data=data}_this24.$initUIComponent();return _this24}_createClass(MaskUI,[{key:"setData",value:function setData(val){if(val&&typeof val=="string"){val=flower.DataManager.getInstance().createData(val)}if(this._data==val){return false}this._data=val;if(this.$UIComponent){flower.Binding.changeData(this)}return true}},{key:"$createShape",value:function $createShape(){var shape=new Rect;shape.percentWidth=100;shape.percentHeight=100;return shape}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){this.$removeFlags(4096);var p=this.$UIComponent;if(this.$hasFlags(1)){this.$getContentBounds()}parent=parent||this.parent;if(p[0]!=null&&p[1]==null&&p[2]!=null){this.width=(p[2]-p[0])*2;this.x=+p[0]}else if(p[0]==null&&p[1]!=null&&p[2]!=null){this.width=(p[1]-p[2])*2;this.x=+2*p[2]-p[1]}else if(p[0]!=null&&p[1]!=null){this.width=parent.width-p[1]-p[0];this.x=+p[0]}else{if(p[0]!=null){this.x=p[0]}if(p[1]!=null){this.x=parent.width-p[1]-this.width}if(p[2]!=null){this.x=(parent.width-this.width)*.5+p[2]}if(p[6]){this.width=parent.width*p[6]/100}}if(p[3]!=null&&p[4]==null&&p[5]!=null){this.height=(p[5]-p[3])*2;this.y=+p[3]}else if(p[3]==null&&p[4]!=null&&p[5]!=null){this.height=(p[4]-p[5])*2;this.y=2*p[5]-p[4]}else if(p[3]!=null&&p[4]!=null){this.height=parent.height-p[4]-p[3];this.y=+p[3]}else{if(p[3]!=null){this.y=p[3]}if(p[4]!=null){this.y=parent.height-p[4]-this.height}if(p[5]!=null){this.y=(parent.height-this.height)*.5+p[5]}if(p[7]){this.height=parent.height*p[7]/100}}this.$validateChildrenUIComponent()}},{key:"$addFlags",value:function $addFlags(flags){if((flags&1)==1&&(this.__flags&4096)!=4096&&(!this.parent||!this.parent.__UIComponent)){this.__flags|=4096;if(this.layout){this.__flags|=8192}}this.__flags|=flags}},{key:"$validateChildrenUIComponent",value:function $validateChildrenUIComponent(){if(this.shape.__UIComponent){this.shape.$validateUIComponent(this)}var children=this.__children;if(children){var child;for(var i=0,len=children.length;i<len;i++){child=children[i];if(child.__UIComponent){child.$validateUIComponent()}}}}},{key:"$resetLayout",value:function $resetLayout(){if(this.$hasFlags(8192)){this.$removeFlags(8192);if(this.layout){this.layout.updateList(this.width,this.height)}}}},{key:"$onFrameEnd",value:function $onFrameEnd(){if(!this.parent.__UIComponent){var flag=false;var count=6;while(count&&this.$hasFlags(4096)){this.$validateUIComponent();_get(Object.getPrototypeOf(MaskUI.prototype),"$onFrameEnd",this).call(this);this.shape.$onFrameEnd();this.$resetLayout();flag=true;count--}if(!flag){_get(Object.getPrototypeOf(MaskUI.prototype),"$onFrameEnd",this).call(this);this.shape.$onFrameEnd();this.$resetLayout()}while(count&&this.$hasFlags(4096)){this.$validateUIComponent();_get(Object.getPrototypeOf(MaskUI.prototype),"$onFrameEnd",this).call(this);this.shape.$onFrameEnd();this.$resetLayout();flag=true;count--}}else{_get(Object.getPrototypeOf(MaskUI.prototype),"$onFrameEnd",this).call(this);this.shape.$onFrameEnd();this.$resetLayout()}}},{key:"dispose",value:function dispose(){flower.Binding.removeChangeObject(this);this.removeAllBindProperty();this.$UIComponent[11].dispose();_get(Object.getPrototypeOf(MaskUI.prototype),"dispose",this).call(this)}},{key:"data",get:function get(){return this._data},set:function set(val){this.setData(val)}}]);return MaskUI}(flower.Mask);UIComponent.register(MaskUI,true);MaskUI.prototype.__UIComponent=true;black.MaskUI=MaskUI;var Button=function(_Group6){_inherits(Button,_Group6);function Button(){_classCallCheck(this,Button);var _this25=_possibleConstructorReturn(this,Object.getPrototypeOf(Button).call(this));_this25._enabled=true;_this25.absoluteState=true;_this25.currentState="up";_this25.addListener(flower.TouchEvent.TOUCH_BEGIN,_this25.__onTouch,_this25);_this25.addListener(flower.TouchEvent.TOUCH_END,_this25.__onTouch,_this25);_this25.addListener(flower.TouchEvent.TOUCH_RELEASE,_this25.__onTouch,_this25);_this25.addListener(flower.MouseEvent.MOUSE_OVER,_this25.__onMouse,_this25);_this25.addListener(flower.MouseEvent.MOUSE_OUT,_this25.__onMouse,_this25);_this25.addListener(flower.Event.REMOVED,_this25.__onRemoved,_this25);return _this25}_createClass(Button,[{key:"$getMouseTarget",value:function $getMouseTarget(touchX,touchY,multiply){var target=_get(Object.getPrototypeOf(Button.prototype),"$getMouseTarget",this).call(this,touchX,touchY,multiply);if(target){target=this}return target}},{key:"__onTouch",value:function __onTouch(e){if(!this.enabled){e.stopPropagation();return}switch(e.type){case flower.TouchEvent.TOUCH_BEGIN:this.currentState="down";break;case flower.TouchEvent.TOUCH_END:case flower.TouchEvent.TOUCH_RELEASE:this.currentState="up";break}}},{key:"__onMouse",value:function __onMouse(e){if(this.currentState=="up"||this.currentState=="over"){switch(e.type){case flower.MouseEvent.MOUSE_OVER:this.currentState="over";break;case flower.MouseEvent.MOUSE_OUT:this.currentState="up";break}}}},{key:"__onRemoved",value:function __onRemoved(e){this.currentState="up"}},{key:"__setEnabled",value:function __setEnabled(val){if(val=="false"){val=false}val=!!val;if(this._enabled==val){return false}this._enabled=val;if(this._enabled){this.currentState="up"}else{this.currentState="disabled"}return true}},{key:"enabled",set:function set(val){this.__setEnabled(val)},get:function get(){return this._enabled}}]);return Button}(Group);UIComponent.registerEvent(Button,1100,"click",flower.TouchEvent.TOUCH_END);black.Button=Button;var ToggleButton=function(_Button){_inherits(ToggleButton,_Button);function ToggleButton(){_classCallCheck(this,ToggleButton);var _this26=_possibleConstructorReturn(this,Object.getPrototypeOf(ToggleButton).call(this));_this26.$ToggleButton={0:false,1:null};return _this26}_createClass(ToggleButton,[{key:"__onTouch",value:function __onTouch(e){if(!this.enabled){e.stopPropagation();return}var p=this.$ToggleButton;switch(e.type){case flower.TouchEvent.TOUCH_BEGIN:if(p[0]){this.currentState="selectedDown"}else{this.currentState="selectedUp"}break;case flower.TouchEvent.TOUCH_END:case flower.TouchEvent.TOUCH_RELEASE:if(e.type==flower.TouchEvent.TOUCH_END){this.selected=!this.selected}if(p[0]){
this.currentState="down"}else{this.currentState="up"}break}}},{key:"__setEnabled",value:function __setEnabled(val){_get(Object.getPrototypeOf(ToggleButton.prototype),"_setEnabled",this).call(this,val);if(val==false&&this.$ToggleButton[0]){this.selected=false}}},{key:"__setSelected",value:function __setSelected(val){var p=this.$ToggleButton;if(val=="false"){val=false}val=!!val;if(!this.enabled||val==p[0]){return}p[0]=val;if(p[1]&&p[1]instanceof flower.Value){p[1].value=val;if(p[0]!=p[1].value){this.__valueChange()}}if(val){this.currentState="down"}else{this.currentState="up"}this.dispatchWith(flower.Event.CHANGE)}},{key:"__valueChange",value:function __valueChange(){var p=this.$ToggleButton;if(p[1]){this.selected=p[1]instanceof flower.Value?p[1].value:p[1]}}},{key:"__onValueChange",value:function __onValueChange(e){this.__valueChange()}},{key:"selected",get:function get(){return this.$ToggleButton[0]},set:function set(val){this.__setSelected(val)}},{key:"value",set:function set(val){var p=this.$ToggleButton;if(p[1]==val){return}if(p[1]&&p[1]instanceof flower.Value){p[1].removeListener(flower.Event.CHANGE,this.__onValueChange,this)}p[1]=val;if(p[1]&&p[1]instanceof flower.Value){p[1].addListener(flower.Event.CHANGE,this.__onValueChange,this)}this.__valueChange()},get:function get(){return this.$ToggleButton[1]}}]);return ToggleButton}(Button);black.ToggleButton=ToggleButton;UIComponent.registerEvent(ToggleButton,1402,"change",flower.Event.CHANGE);var CheckBox=function(_ToggleButton){_inherits(CheckBox,_ToggleButton);function CheckBox(){_classCallCheck(this,CheckBox);return _possibleConstructorReturn(this,Object.getPrototypeOf(CheckBox).call(this))}return CheckBox}(ToggleButton);black.CheckBox=CheckBox;var RadioButton=function(_ToggleButton2){_inherits(RadioButton,_ToggleButton2);function RadioButton(){_classCallCheck(this,RadioButton);return _possibleConstructorReturn(this,Object.getPrototypeOf(RadioButton).call(this))}_createClass(RadioButton,[{key:"__setSelected",value:function __setSelected(val){if(val==false&&this._group&&this._group.selection==this){return}_get(Object.getPrototypeOf(RadioButton.prototype),"__setSelected",this).call(this,val);if(this._group){this._group.$itemSelectedChange(this)}this.dispatchWith(flower.Event.CHANGE)}},{key:"__setGroupName",value:function __setGroupName(val){if(val==this._groupName){return}if(this._group){this._group.$removeButton(this);this._group=null}this._groupName=val;this._group=RadioButtonGroup.$addButton(this)}},{key:"groupName",get:function get(){return this._groupName},set:function set(val){this.__setGroupName(val)}},{key:"group",get:function get(){return this._group}}]);return RadioButton}(ToggleButton);black.RadioButton=RadioButton;UIComponent.registerEvent(RadioButton,1401,"change",flower.Event.CHANGE);var RadioButtonGroup=function(_Group7){_inherits(RadioButtonGroup,_Group7);function RadioButtonGroup(groupName){_classCallCheck(this,RadioButtonGroup);var _this29=_possibleConstructorReturn(this,Object.getPrototypeOf(RadioButtonGroup).call(this));_this29._buttons=[];_this29._enabled=true;if(groupName==null||groupName==""){groupName="group"+_this29.id}_this29._groupName=groupName;RadioButtonGroup.groups.push(_this29);return _this29}_createClass(RadioButtonGroup,[{key:"addChildAt",value:function addChildAt(child){var index=arguments.length<=1||arguments[1]===undefined?0:arguments[1];_get(Object.getPrototypeOf(RadioButtonGroup.prototype),"addChildAt",this).call(this,child);if(child instanceof RadioButton&&child.group!=this){child.groupName=this._groupName}}},{key:"$itemSelectedChange",value:function $itemSelectedChange(button){if(button.selected){this.selection=button}}},{key:"$addButton",value:function $addButton(button){for(var i=0;i<this._buttons.length;i++){if(this._buttons[i]==button){return}}this._buttons.push(button);if(this.enabled==false){button.enabled=this.enabled}if(button.selected){if(!this._selection){this.selection=button}else{button.selected=false}}}},{key:"$removeButton",value:function $removeButton(button){for(var i=0;i<this._buttons.length;i++){if(this._buttons[i]==button){this._buttons.splice(i,1);if(button==this._selection){this.selection=null}return button}}return null}},{key:"__setSelection",value:function __setSelection(val){this._selection=val;if(this._selection){this._selection.selected=true}for(var i=0;i<this._buttons.length;i++){if(this._buttons[i]!=this._selection){this._buttons[i].selected=false}}this.dispatchWith(flower.Event.CHANGE)}},{key:"selection",get:function get(){return this._selection},set:function set(val){if(!this._enabled||this._selection==val){return}this.__setSelection(val)}},{key:"groupName",get:function get(){return this._groupName}},{key:"enabled",get:function get(){return this._enabled},set:function set(val){if(val=="false"){val=false}val=!!val;if(this._enabled==val){return}this._enabled=val;for(var i=0;i<this._buttons.length;i++){this._buttons[i].enabled=this._enabled}}}],[{key:"$addButton",value:function $addButton(button){if(button.groupName&&button.groupName!=""){var group;var groupGroup;var list=RadioButtonGroup.groups;for(var i=0,len=list.length;i<len;i++){if(list[i].groupName==button.groupName){group=list[i];break}}if(!group){group=new RadioButtonGroup(button.groupName)}group.$addButton(button);return group}return null}}]);return RadioButtonGroup}(Group);RadioButtonGroup.groups=[];black.RadioButtonGroup=RadioButtonGroup;UIComponent.registerEvent(RadioButtonGroup,1400,"change",flower.Event.CHANGE);var ToggleSwitch=function(_ToggleButton3){_inherits(ToggleSwitch,_ToggleButton3);function ToggleSwitch(){_classCallCheck(this,ToggleSwitch);return _possibleConstructorReturn(this,Object.getPrototypeOf(ToggleSwitch).call(this))}return ToggleSwitch}(ToggleButton);black.ToggleSwitch=ToggleSwitch;var ListBase=function(_DataGroup){_inherits(ListBase,_DataGroup);function ListBase(){_classCallCheck(this,ListBase);var _this31=_possibleConstructorReturn(this,Object.getPrototypeOf(ListBase).call(this));_this31.requireSelection=true;_this31.itemSelectedEnabled=true;_this31.itemClickedEnabled=true;return _this31}return ListBase}(DataGroup);black.ListBase=ListBase;var List=function(_ListBase){_inherits(List,_ListBase);function List(){_classCallCheck(this,List);var _this32=_possibleConstructorReturn(this,Object.getPrototypeOf(List).call(this));_this32.layout=new VerticalLayout;return _this32}return List}(ListBase);black.List=List;var TabBar=function(_ListBase2){_inherits(TabBar,_ListBase2);function TabBar(){_classCallCheck(this,TabBar);var _this33=_possibleConstructorReturn(this,Object.getPrototypeOf(TabBar).call(this));_this33.$TabBar={0:false,1:null,2:null,3:null};_this33.layout=new HorizontalLayout;_this33.layout.fixElementSize=false;return _this33}_createClass(TabBar,[{key:"$setDataProvider",value:function $setDataProvider(val){var d=this.dataProvider;if(_get(Object.getPrototypeOf(TabBar.prototype),"$setDataProvider",this).call(this,val)){if(d){d.removeListener(flower.Event.CHANGE,this.__onDataProviderSelectedChange,this)}if(val&&val instanceof flower.ViewStack){val.addListener(flower.Event.CHANGE,this.__onDataProviderSelectedChange,this)}}}},{key:"__onDataProviderSelectedChange",value:function __onDataProviderSelectedChange(e){this.selectedItem=this.dataProvider.selectedChild}},{key:"__setSelectedItemData",value:function __setSelectedItemData(item){_get(Object.getPrototypeOf(TabBar.prototype),"__setSelectedItemData",this).call(this,item);if(this.dataProvider instanceof flower.ViewStack){this.dataProvider.selectedChild=this.selectedItem}}},{key:"showMore",value:function showMore(e){var p=this.$TabBar;var moreList=p[3];if(moreList){var point=this.moreButton.localToGlobal();moreList.x=point.x;moreList.y=point.y+this.moreButton.height;flower.MenuManager.showMenu(moreList)}}},{key:"more",get:function get(){return this.$TabBar[0]},set:function set(val){if(val=="false"){val=false}val=!!val;if(this.$TabBar[0]==val){return}this.$TabBar[0]=val;if(!this.$TabBar[2]){this.$TabBar[2]=new flower.ArrayValue}this.$invalidateContentBounds()}},{key:"moreData",get:function get(){if(!this.$TabBar[2]){this.$TabBar[2]=new flower.ArrayValue}return this.$TabBar[2]}},{key:"moreButton",get:function get(){return this.$TabBar[1]},set:function set(val){if(this.$TabBar[1]==val){return}if(this.$TabBar[1]){this.$TabBar[1].removeListener(flower.TouchEvent.TOUCH_END,this.showMore,this);if(this.$TabBar[1].parent==this){this.removeChild(this.$TabBar[1])}}this.$TabBar[1]=val;if(this.$TabBar[1]){this.$TabBar[1].addListener(flower.TouchEvent.TOUCH_END,this.showMore,this)}this.$invalidateContentBounds()}},{key:"moreList",get:function get(){return this.$TabBar[3]},set:function set(val){if(this.$TabBar[3]==val){return}this.$TabBar[3]=val;val.dataProvider=this.moreData}}]);return TabBar}(ListBase);black.TabBar=TabBar;var ViewStack=function(_Group8){_inherits(ViewStack,_Group8);function ViewStack(){_classCallCheck(this,ViewStack);var _this34=_possibleConstructorReturn(this,Object.getPrototypeOf(ViewStack).call(this));_this34._items=[];_this34._selectedIndex=-1;return _this34}_createClass(ViewStack,[{key:"addChild",value:function addChild(display){var find=false;for(var i=0;i<this._items.length;i++){if(this._items[i]==display){this._items.splice(i,1);find=true;break}}this._items.push(display);this.dispatchWith(flower.Event.CHANGE);if(this._selectedIndex<0){this._setSelectedIndex(0)}if(!find){this.dispatchWith(flower.Event.ADDED,display)}}},{key:"addChildAt",value:function addChildAt(display,index){var find=false;for(var i=0;i<this._items.length;i++){if(this._items[i]==display){this._items.splice(i,1);find=true;break}}this._items.splice(i,0,display);this.dispatchWith(flower.Event.CHANGE);if(this._selectedIndex<0){this._setSelectedIndex(0)}if(!find){this.dispatchWith(flower.Event.ADDED,display)}}},{key:"removeChild",value:function removeChild(display){for(var i=0;i<this._items.length;i++){if(this._items[i]==display){this._items.splice(i,1);if(display==this._selectedItem){this._setSelectedIndex(0);this.dispatchWith(flower.Event.CHANGE);this.dispatchWith(flower.Event.REMOVED,display)}return display}}return null}},{key:"$removeChild",value:function $removeChild(display){_get(Object.getPrototypeOf(ViewStack.prototype),"$removeChild",this).call(this,display);this.removeChild(display)}},{key:"removeChildAt",value:function removeChildAt(index){var display=this._items.splice(index,1)[0];if(display==this._selectedItem){this._selectedItem=this._items[0];this._selectedIndex=0;_get(Object.getPrototypeOf(ViewStack.prototype),"removeChild",this).call(this,display);this.dispatchWith(flower.Event.CHANGE);this.dispatchWith(flower.Event.REMOVED,display)}else{flower.DebugInfo.debug("ViewStack 设置 removeChildAt 超出索引范围:"+index,DebugInfo.ERROR)}return display}},{key:"getChildIndex",value:function getChildIndex(display){if(display){for(var i=0;i<this._items.length;i++){if(this._items[i]==display){return i}}}return-1}},{key:"setChildIndex",value:function setChildIndex(display,index){for(var i=0;i<this._items.length;i++){if(this._items[i]==display){this._items.splice(i,1);this._items.splice(index,0,display);this.dispatchWith(flower.Event.CHANGE);return display}}return null}},{key:"sortChild",value:function sortChild(key){var opt=arguments.length<=1||arguments[1]===undefined?0:arguments[1];_get(Object.getPrototypeOf(ViewStack.prototype),"sortChild",this).call(this,key,opt);this.dispatchWith(flower.Event.CHANGE)}},{key:"_setSelectedIndex",value:function _setSelectedIndex(val){if(this._selectedItem){_get(Object.getPrototypeOf(ViewStack.prototype),"removeChild",this).call(this,this._selectedItem)}this._selectedItem=null;this._selectedIndex=-1;var item=this._items[val];if(item){this._selectedItem=item;this._selectedIndex=val;_get(Object.getPrototypeOf(ViewStack.prototype),"addChildAt",this).call(this,this._selectedItem,this.numChildren)}this.dispatchWith(flower.Event.CHANGE,this._selectedItem);this.dispatchWith(flower.Event.CHANGE)}},{key:"getItemAt",value:function getItemAt(index){return this._items[index]}},{key:"getItemIndex",value:function getItemIndex(item){return this.getChildIndex(item)}},{key:"setItemIndex",value:function setItemIndex(item,index){var itemIndex=this.getItemIndex(item);if(itemIndex<0||itemIndex==index){return}this._items.splice(itemIndex,1);if(this._selectedIndex!=-1&&this._selectedIndex>itemIndex){this._selectedIndex--}this._items.splice(index,0,item);if(this._selectedIndex!=-1&&this._selectedIndex>=index){this._selectedIndex++}}},{key:"length",get:function get(){return this._items.length}},{key:"selectedIndex",set:function set(val){val=+val||0;if(val==this._selectedIndex){return}if(val<0||val>=this._items.length){val=-1}this._setSelectedIndex(val)},get:function get(){return this._selectedIndex}},{key:"selectedChild",set:function set(val){var index=this.getChildIndex(val);this._setSelectedIndex(index)},get:function get(){return this._selectedItem}}]);return ViewStack}(Group);black.ViewStack=ViewStack;UIComponent.registerEvent(ViewStack,1500,"selectedItemChange",flower.Event.CHANGE);var Scroller=function(_MaskUI){_inherits(Scroller,_MaskUI);function Scroller(){_classCallCheck(this,Scroller);var _this35=_possibleConstructorReturn(this,Object.getPrototypeOf(Scroller).call(this));_this35.$Scroller={0:null,1:flower.Size.create(0,0),2:0,3:0,4:[],5:[],6:[],7:.3,8:0,9:18,10:null,11:null,12:"auto",13:"auto",14:false,15:false,16:false,20:true,52:0,53:0};_this35.addListener(flower.TouchEvent.TOUCH_BEGIN,_this35.__onTouchScroller,_this35);_this35.addListener(flower.TouchEvent.TOUCH_MOVE,_this35.__onTouchScroller,_this35);_this35.addListener(flower.TouchEvent.TOUCH_END,_this35.__onTouchScroller,_this35);_this35.addListener(flower.TouchEvent.TOUCH_RELEASE,_this35.__onTouchScroller,_this35);_this35.width=_this35.height=100;return _this35}_createClass(Scroller,[{key:"addChildAt",value:function addChildAt(child,index){if(child instanceof flower.HScrollBar){_get(Object.getPrototypeOf(Scroller.prototype),"addChildAt",this).call(this,child,index);this.horizontalScrollBar=child}else if(child instanceof flower.VScrollBar){_get(Object.getPrototypeOf(Scroller.prototype),"addChildAt",this).call(this,child,index);this.verticalScrollBar=child}else{if(index==this.numChildren||index==this.numChildren-1){if(index==this.numChildren&&this.numChildren-1>=0&&this.getChildAt(this.numChildren-1)instanceof flower.ScrollBar){index--}if(index==this.numChildren-1&&this.numChildren-2>=0&&this.getChildAt(this.numChildren-2)instanceof flower.ScrollBar){index--}}_get(Object.getPrototypeOf(Scroller.prototype),"addChildAt",this).call(this,child,index);if(this.viewport==null){this.viewport=child}}}},{key:"$createShape",value:function $createShape(){var shape=new Rect;shape.percentWidth=100;shape.percentHeight=100;return shape}},{key:"__onTouchScroller",value:function __onTouchScroller(e){var p=this.$Scroller;if(!p[0]||!p[20]){return}var x=this.mouseX;var y=this.mouseY;switch(e.type){case flower.TouchEvent.TOUCH_BEGIN:if(p[8]){p[8].dispose();p[8]=null}p[2]=x-p[0].x;p[3]=y-p[0].y;p[4].length=p[5].length=p[6].length=0;p[14]=true;p[15]=false;p[16]=false;break;case flower.TouchEvent.TOUCH_MOVE:if((Math.abs(x-p[0].x-p[2])>p[9]||Math.abs(y-p[0].y-p[3])>p[9])&&p[0]instanceof flower.DataGroup){p[0].$releaseItem()}if(!p[15]&&this.$Scroller[12]!="off"&&Math.abs(x-p[0].x-p[2])>p[9]&&p[0].contentWidth>p[0].width){p[15]=true;p[2]=x-p[0].x}if(!p[16]&&this.$Scroller[13]!="off"&&Math.abs(y-p[0].y-p[3])>p[9]&&p[0].contentHeight>p[0].height){p[16]=true;p[3]=y-p[0].y}var _x=p[0].x;var _y=p[0].y;if(p[15]){p[0].x=x-p[2];if(p[0].x>0){p[0].x=p[0].x*p[7]}if(p[0].x<-p[0].contentWidth+p[0].width){p[0].x=-p[0].contentWidth+p[0].width+(p[0].x-(-p[0].contentWidth+p[0].width))*p[7]}}if(p[16]){p[0].y=y-p[3];if(p[0].y>0){p[0].y=p[0].y*p[7]}if(p[0].y<-p[0].contentHeight+p[0].height){p[0].y=-p[0].contentHeight+p[0].height+(p[0].y-(-p[0].contentHeight+p[0].height))*p[7]}}p[4].push(p[0].x-_x);p[5].push(p[0].y-_y);p[6].push(flower.CoreTime.currentTime);if(p[4].length>4){p[4].shift();p[5].shift();p[6].shift()}break;case flower.TouchEvent.TOUCH_END:case flower.TouchEvent.TOUCH_RELEASE:p[14]=p[15]=p[16]=false;var timeGap=.5;if(p[6].length){timeGap=flower.CoreTime.currentTime-p[6][0]}var disX=0;var disY=0;for(var i=0;i<p[4].length;i++){disX+=p[4][i];disY+=p[5][i]}disX=disX*100/timeGap;disY=disY*100/timeGap;if(disX<-600){disX=-600}if(disX>600){disX=600}if(disY<-600){disY=-600}if(disY>600){disY=600}var toX=p[0].x+disX*5;var toY=p[0].y+disY*5;var flag=true;if(-toX+p[0].width>p[0].contentWidth){toX=p[0].width-p[0].contentWidth;flag=false}if(toX>0){toX=0;flag=false}if(toY<-p[0].contentHeight+p[0].height){toY=p[0].height-p[0].contentHeight;if(p[0]==961){flower.breakPoint();p[0].contentHeight}flag=false}if(toY>0){toY=0;flag=false}if(flag&&disX==0&&disY==0&&timeGap>250){break}var timeX=Math.abs(toX-p[0].x)/350;var timeY=Math.abs(toY-p[0].y)/350;var time=timeX>timeY?timeX:timeY;if(time<.5){time=.5}if(time>5){time=5}p[8]=flower.Tween.to(p[0],time,{x:toX,y:toY},flower.Ease.CUBIC_EASE_OUT);break}}},{key:"$onFrameEnd",value:function $onFrameEnd(){var p=this.$Scroller;if(p[0]){if(p[10]){if(p[12]=="on"){if(p[10].autoVisibility){p[10].visible=p[15]?true:false}}else if(p[12]=="off"){p[10].visible=false}else if(p[12]=="auto"){if(p[10].autoVisibility){p[10].visible=p[15]&&p[0].contentWidth>p[0].width?true:false}else{p[10].visible=p[0].contentWidth>p[0].width?true:false}}}if(p[11]){if(p[13]=="on"){if(p[11].autoVisibility){p[11].visible=p[16]?true:false}}else if(p[13]=="off"){p[11].visible=false}else if(p[13]=="auto"){if(p[11].autoVisibility){p[11].visible=p[16]&&p[0].contentHeight>p[0].height?true:false}else{p[11].visible=p[0].contentHeight>p[0].height?true:false}}}p[0].width=this.width-(p[11]&&p[13]!="off"&&!p[11].autoVisibility?p[11].width:0);p[0].height=this.height-(p[10]&&p[12]!="off"&&!p[10].autoVisibility?p[10].height:0)}if(this.$hasFlags(4096)&&!this.parent.__UIComponent){this.$validateUIComponent()}_get(Object.getPrototypeOf(Scroller.prototype),"$onFrameEnd",this).call(this);this.$resetLayout()}},{key:"dispose",value:function dispose(){flower.Size.release(this.$Scroller[1]);_get(Object.getPrototypeOf(Scroller.prototype),"dispose",this).call(this)}},{key:"$setViewport",value:function $setViewport(val){var p=this.$Scroller;if(typeof val=="string"){var clazz=$root[val];if(!clazz){clazz=flower.UIParser.getLocalUIClass(val.split(":")[val.split(":").length-1],val.split(":").length>1?val.split(":")[0]:"");if(!clazz){sys.$error(3201,val)}}val=new clazz}if(p[0]==val){return}p[0]=val;p[0].viewer=this;if(p[0].parent==null){this.addChild(p[0])}if(p[10]){p[10].viewport=p[0]}if(p[11]){p[11].viewport=p[0]}}},{key:"$setHorizontalScrollBar",value:function $setHorizontalScrollBar(val){var p=this.$Scroller;if(p[10]==val){return}if(val==null){p[10].viewport=null}p[10]=val;if(p[10]){p[10].viewport=p[0];if(p[10].parent==null){this.addChild(p[10])}}}},{key:"$setVerticalScrollBar",value:function $setVerticalScrollBar(val){var p=this.$Scroller;if(p[11]==val){return}if(val==null){p[11].viewport=null}p[11]=val;if(p[11]){p[11].viewport=p[0];if(p[11].parent==null){this.addChild(p[11])}}}},{key:"$setWidth",value:function $setWidth(val){this.$Scroller[1].width=val}},{key:"$setHeight",value:function $setHeight(val){this.$Scroller[1].height=val}},{key:"$getWidth",value:function $getWidth(){return this.$Scroller[1].width}},{key:"$getHeight",value:function $getHeight(){return this.$Scroller[1].height}},{key:"viewport",set:function set(val){this.$setViewport(val)},get:function get(){return this.$Scroller[0]}},{key:"horizontalScrollBar",set:function set(val){this.$setHorizontalScrollBar(val)}},{key:"verticalScrollBar",set:function set(val){this.$setVerticalScrollBar(val)}},{key:"scrollPolicyH",set:function set(val){this.$Scroller[12]=val},get:function get(){return this.$Scroller[12]}},{key:"scrollPolicyV",set:function set(val){this.$Scroller[13]=val},get:function get(){return this.$Scroller[13]}},{key:"scrollThreshold",set:function set(val){val=+val||0;if(val<0){val=0}this.$Scroller[9]=val},get:function get(){return this.$Scroller[9]}},{key:"scrollOut",set:function set(val){val=+val||0;if(val<0){val=0}this.$Scroller[7]=val},get:function get(){return this.$Scroller[7]}},{key:"scrollable",set:function set(val){if(val=="false"){val=false}val=!!val;if(val==this.$Scroller[20]){return}this.$Scroller[20]=val},get:function get(){return this.$Scroller[20]}}]);return Scroller}(MaskUI);black.Scroller=Scroller;var ComboBox=function(_Group9){_inherits(ComboBox,_Group9);function ComboBox(){_classCallCheck(this,ComboBox);var _this36=_possibleConstructorReturn(this,Object.getPrototypeOf(ComboBox).call(this));_this36.$comboBox={0:null,1:null,2:null,3:false,4:"label",5:null,6:"type",7:null,8:null,9:false};return _this36}_createClass(ComboBox,[{key:"__onClickButton",value:function __onClickButton(e){this.isOpen=!this.isOpen}},{key:"__listRemoved",value:function __listRemoved(e){this.$comboBox[3]=false}},{key:"__listSelectItemChange",value:function __listSelectItemChange(e){var p=this.$comboBox;if(p[9]){return}p[8]=e.data;if(p[0]){if(p[8]&&p[8][p[4]]){p[0].text=p[8][p[4]]}else{p[0].text=""}}if(e){this.dispatch(e)}if(p[6]&&p[7]&&p[8]){if(p[7]instanceof flower.Value){p[7].value=p[8][p[6]]}}}},{key:"__listClickItem",value:function __listClickItem(e){flower.MenuManager.hideMenu()}},{key:"__typeValueChange",value:function __typeValueChange(){var p=this.$comboBox;if(p[6]&&p[7]){var array=p[5];var value=p[7]instanceof flower.Value?p[7].value:p[7];this.selectedItem=array.getItemWith(p[6],value)}}},{key:"__onTypeValueChange",value:function __onTypeValueChange(e){this.__typeValueChange()}},{key:"label",set:function set(val){var p=this.$comboBox;if(p[0]==val){return}p[0]=val;if(val){val.touchEnabled=false;if(val.parent!=this){this.addChild(val)}}if(p[0]){if(p[8]&&p[8][p[4]]){p[0].text=p[8][p[4]]}else{p[0].text=""}}},get:function get(){return this.$comboBox[0]}},{key:"button",set:function set(val){var p=this.$comboBox;if(p[1]==val){return}if(p[1]){p[1].removeListener(flower.TouchEvent.TOUCH_END,this.__onClickButton,this)}p[1]=val;if(val){val.addListener(flower.TouchEvent.TOUCH_END,this.__onClickButton,this);if(val.parent!=this){this.addChild(val)}}},get:function get(){return this.$comboBox[1]}},{key:"list",set:function set(val){var p=this.$comboBox;if(p[2]==val){return}if(p[2]){p[2].removeListener(flower.Event.REMOVED,this.__listRemoved,this);p[2].removeListener(flower.Event.SELECTED_ITEM_CHANGE,this.__listSelectItemChange,this);p[2].removeListener(flower.Event.CLICK_ITEM,this.__listClickItem,this)}p[2]=val;if(val){val.dataProvider=p[5];if(p[8]){val.selectedItem=p[8]}val.addListener(flower.Event.REMOVED,this.__listRemoved,this);val.addListener(flower.Event.SELECTED_ITEM_CHANGE,this.__listSelectItemChange,this);val.addListener(flower.Event.CLICK_ITEM,this.__listClickItem,this)}},get:function get(){return this.$comboBox[2]}},{key:"isOpen",get:function get(){return this.$comboBox[3]},set:function set(val){if(val=="false"){val=false}val=!!val;if(val==this.$comboBox[3]){return}this.$comboBox[3]=val;if(val){var list=this.$comboBox[2];if(this.stage&&list){var point=flower.Point.create();this.localToGlobal(point);flower.Point.release(point);flower.MenuManager.showMenu(list,point.x,point.y+this.height,false)}}else{}}},{key:"labelField",get:function get(){return this.$comboBox[4]},set:function set(val){var p=this.$comboBox;if(p[4]==val){return}p[4]=val;if(p[0]){if(p[8]&&p[8][p[4]]){p[0].text=p[8][p[4]]}else{p[0].text=""}}}},{key:"valueField",get:function get(){return this.$comboBox[6]},set:function set(val){if(this.$comboBox[6]==val){return}this.$comboBox[6]=val;this.__typeValueChange()}},{key:"value",get:function get(){return this.$comboBox[7]},set:function set(val){var p=this.$comboBox;if(p[7]==val){return}if(p[7]&&p[7]instanceof flower.Value){p[7].removeListener(flower.Event.CHANGE,this.__onTypeValueChange,this)}p[7]=val;if(p[7]){p[9]=true;if(p[7]instanceof flower.Value){p[7].addListener(flower.Event.CHANGE,this.__onTypeValueChange,this);this.dataProvider=new flower.ArrayValue(p[7].enumList)}p[9]=false;this.__typeValueChange()}}},{key:"dataProvider",get:function get(){return this.$comboBox[5]},set:function set(val){var p=this.$comboBox;if(p[5]==val){return}p[5]=val;if(!p[9]){if(p[5]==null||p[5].length==0){p[8]=null}else{p[8]=p[5][0]}}if(this.list){this.list.dataProvider=p[5];if(!p[9]&&this.list&&p[8]){this.list.selectedItem=p[8]}}}},{key:"selectedItem",get:function get(){return this.$comboBox[8]},set:function set(val){var p=this.$comboBox;if(p[8]==val){return}if(p[5]==null){sys.$error(3102)}var array=p[5];var index=array.getItemIndex(val);if(index==-1){p[8]=null;if(this.list){this.list.selectedItem=null}if(p[0]){p[0].text=""}}else{p[8]=val;if(this.list){this.list.selectedItem=val}if(p[0]){if(p[8]&&p[8][p[4]]){p[0].text=p[8][p[4]]}else{p[0].text=""}}}}},{key:"selectedIndex",get:function get(){var p=this.$comboBox;return p[5]==null?-1:p[5].getItemIndex(p[8])},set:function set(val){var p=this.$comboBox;var item;if(p[5]==null){sys.$error(3102)}if(val!=-1){if(val<0||val>=p[5].length){sys.$error(3101,val,p[0].length)}item=p[5][val]}this.selectedItem=item}}]);return ComboBox}(Group);black.ComboBox=ComboBox;var Panel=function(_Group10){_inherits(Panel,_Group10);function Panel(){_classCallCheck(this,Panel);var _this37=_possibleConstructorReturn(this,Object.getPrototypeOf(Panel).call(this));_this37.$Panel={0:"",1:null,2:null,3:PanelScaleMode.NO_SCALE,4:null,5:""};return _this37}_createClass(Panel,[{key:"__changeTitle",value:function __changeTitle(){var p=this.$Panel;if(p[0]&&p[1]){p[1].text=p[0]}}},{key:"$validateUIComponent",value:function $validateUIComponent(parent){this.$removeFlags(4096);var p=this.$UIComponent;if(this.$hasFlags(1)){this.$getContentBounds()}parent=parent||this.parent;if(p[0]!=null&&p[1]==null&&p[2]!=null){this.width=(p[2]-p[0])*2;this.x=p[0]}else if(p[0]==null&&p[1]!=null&&p[2]!=null){this.width=(p[1]-p[2])*2;this.x=2*p[2]-p[1]}else if(p[0]!=null&&p[1]!=null){this.width=parent.width-p[1]-p[0];this.x=p[0]}else{if(p[0]!=null){this.x=p[0]}if(p[1]!=null){this.x=parent.width-p[1]-this.width}if(p[2]!=null){this.x=(parent.width-this.width)*.5+p[2]}if(p[6]){this.width=parent.width*p[6]/100}}if(p[3]!=null&&p[4]==null&&p[5]!=null){this.height=(p[5]-p[3])*2;this.y=p[3]}else if(p[3]==null&&p[4]!=null&&p[5]!=null){this.height=(p[4]-p[5])*2;this.y=2*p[5]-p[4]}else if(p[3]!=null&&p[4]!=null){this.height=parent.height-p[4]-p[3];this.y=p[3]}else{if(p[3]!=null){this.y=p[3]}if(p[4]!=null){this.y=parent.height-p[4]-this.height}if(p[5]!=null){this.y=(parent.height-this.height)*.5+p[5]}if(p[7]){this.height=parent.height*p[7]/100}}this.$checkSetting();this.$validateChildrenUIComponent()}},{key:"$checkSetting",value:function $checkSetting(){if(this.width&&this.height&&this.$Panel[3]!=PanelScaleMode.NO_SCALE){var scaleMode=this.$Panel[3];var scaleX=this.parent.width/this.width;var scaleY=this.parent.height/this.height;if(scaleMode==PanelScaleMode.SHOW_ALL){this.scaleX=scaleX<scaleY?scaleX:scaleY;this.scaleY=scaleX<scaleY?scaleX:scaleY}else if(scaleMode==PanelScaleMode.NO_BORDER){this.scaleX=scaleX>scaleY?scaleX:scaleY;this.scaleY=scaleX>scaleY?scaleX:scaleY}else if(scaleMode==PanelScaleMode.SCALE_WIDTH){this.height=this.parent.height/scaleX;this.scaleX=scaleX;this.scaleY=scaleX}else if(scaleMode==PanelScaleMode.SCALE_HEIGHT){this.width=this.parent.width/scaleY;this.scaleX=scaleY;this.scaleY=scaleY}}}},{key:"$onClose",value:function $onClose(){this.dispatchWith(flower.Event.CLOSE);this.closePanel()}},{key:"closePanel",value:function closePanel(){if(this.parent){this.parent.removeChild(this)}}},{key:"title",set:function set(val){if(this.$Panel[0]==val){return}this.$Panel[0]=val;this.__changeTitle()},get:function get(){return this.$Panel[0]}},{key:"titleLabel",get:function get(){return this.$Panel[1]},set:function set(val){if(this.$Panel[1]==val){return}if(this.$Panel[1]&&this.$Panel[1].parent&&this.$Panel[1].parent!=this){this.$Panel[1].parent.removeChild(this.$Panel[1])}this.$Panel[1]=val;if(val.parent!=this){this.addChild(val)}this.__changeTitle()}},{key:"closeButton",get:function get(){return this.$Panel[2]},set:function set(val){if(this.$Panel[2]==val){return}if(this.$Panel[2]){if(this.$Panel[2].parent&&this.$Panel[2].parent!=this){this.$Panel[2].parent.removeChild(this.$Panel[2])}this.$Panel[2].removeListener(flower.TouchEvent.TOUCH_END,this.$onClose,this)}this.$Panel[2]=val;if(val){if(val.parent!=this){this.addChild(val)}val.addListener(flower.TouchEvent.TOUCH_END,this.$onClose,this)}}},{key:"iconImage",get:function get(){return this.$Panel[4]},set:function set(val){if(this.$Panel[4]==val){return}if(this.$Panel[4]&&this.$Panel[4].parent&&this.$Panel[4].parent!=this){this.$Panel[4].parent.removeChild(this.$Panel[4])}this.$Panel[4]=val;if(val){val.source=this.$Panel[5];if(val.parent!=this){this.addChild(val)}}}},{key:"icon",get:function get(){return this.$Panel[5]},set:function set(val){if(this.$Panel[5]==val){return}if(this.$Panel[4]){this.$Panel[4].source=val}}},{key:"scaleMode",get:function get(){return this.$Panel[3]},set:function set(val){if(this.$Panel[3]==val){return}this.$Panel[3]=val;this.$invalidateContentBounds()}}]);return Panel}(Group);UIComponent.registerEvent(Panel,1120,"close",flower.Event.CLOSE);black.Panel=Panel;var Alert=function(_Panel){_inherits(Alert,_Panel);function Alert(){_classCallCheck(this,Alert);var _this38=_possibleConstructorReturn(this,Object.getPrototypeOf(Alert).call(this));_this38.$Alert={0:null,1:null,2:null,3:""};return _this38}_createClass(Alert,[{key:"$onConfirm",value:function $onConfirm(e){this.dispatchWith(flower.Event.CONFIRM);this.closePanel()}},{key:"$onCancel",value:function $onCancel(e){this.dispatchWith(flower.Event.CANCEL);this.closePanel()}},{key:"confirmButton",get:function get(){return this.$Alert[0]},set:function set(val){if(this.$Alert[0]==val){return}if(this.$Alert[0]){this.$Alert[0].removeListener(flower.TouchEvent.TOUCH_END,this.$onConfirm,this);if(this.$Alert[0].parent&&this.$Alert[0].parent!=this){this.$Alert[0].parent.removeChild(this.$Alert[0])}}this.$Alert[0]=val;if(val){val.addListener(flower.TouchEvent.TOUCH_END,this.$onConfirm,this);if(val.parent!=this){this.addChild(val)}}}},{key:"cancelButton",get:function get(){return this.$Alert[1]},set:function set(val){if(this.$Alert[1]==val){return}if(this.$Alert[1]){this.$Alert[1].removeListener(flower.TouchEvent.TOUCH_END,this.$onCancel,this);if(this.$Alert[1].parent&&this.$Alert[1].parent!=this){this.$Alert[1].parent.removeChild(this.$Alert[1])}}this.$Alert[1]=val;if(val){this.$Alert[1].addListener(flower.TouchEvent.TOUCH_END,this.$onCancel,this);if(val.parent!=this){this.addChild(val)}}}},{key:"contentLabel",get:function get(){return this.$Alert[2]},set:function set(val){if(this.$Alert[2]==val){return}if(this.$Alert[2]&&this.$Alert[2].parent&&this.$Alert[2].parent!=this){this.$Alert[2].parent.removeChild(this.$Alert[2])}this.$Alert[2]=val;if(val){val.text=this.$Alert[3];if(val.parent!=this){this.addChild(val)}}}},{key:"content",get:function get(){return this.$Alert[3]},set:function set(val){if(this.$Alert[3]==val){return this.$Alert[3]}this.$Alert[3]=val;if(this.$Alert[2]){this.$Alert[2].text=val}}}]);return Alert}(Panel);UIComponent.registerEvent(Panel,1130,"confirm",flower.Event.CONFIRM);UIComponent.registerEvent(Panel,1131,"cancel",flower.Event.CANCEL);black.Alert=Alert;var Tree=function(_DataGroup2){_inherits(Tree,_DataGroup2);function Tree(){_classCallCheck(this,Tree);var _this39=_possibleConstructorReturn(this,Object.getPrototypeOf(Tree).call(this));_this39.$Tree={0:null,1:new flower.ArrayValue,2:{},3:"path"};_this39.requireSelection=true;_this39.itemSelectedEnabled=true;_this39.itemClickedEnabled=true;_this39.layout=new VerticalLayout;_get(Object.getPrototypeOf(Tree.prototype),"$setDataProvider",_this39).call(_this39,_this39.$Tree[1]);return _this39}_createClass(Tree,[{key:"$getDataProvider",value:function $getDataProvider(){
return this.$Tree[0]}},{key:"$setDataProvider",value:function $setDataProvider(val){var p=this.$Tree;if(p[0]==val){return}if(p[0]){p[0].removeListener(flower.Event.CHANGE,this.__onTreeDataUpdate,this);p[0].removeListener(flower.Event.REMOVED,this.__onRemovedTreeDataUpdate,this)}p[0]=val;if(p[0]){p[0].addListener(flower.Event.CHANGE,this.__onTreeDataUpdate,this);p[0].addListener(flower.Event.REMOVED,this.__onRemovedTreeDataUpdate,this)}this.__onTreeDataUpdate(null)}},{key:"__onRemovedTreeDataUpdate",value:function __onRemovedTreeDataUpdate(e){var item=e.data;if(item.open&&item.open instanceof flower.EventDispatcher){item.open.removeListener(flower.Event.CHANGE,this.__onOpenItem,this)}}},{key:"__onTreeDataUpdate",value:function __onTreeDataUpdate(e){var p=this.$Tree;var treeData=p[0];var parentData=p[1];var openURL=p[2];var pathField=p[3];if(!treeData||!treeData.length){parentData.removeAll()}else{parentData.removeAll();var item;var url;var depth;var keys=Object.keys(openURL);var rootURL;var rootURLDepth=-1;var rootList=[];var urlList={};for(var i=0,len=keys.length;i<len;i++){openURL[keys[i]].state=false}for(var i=0,len=treeData.length;i<len;i++){item=treeData.list[i];if(typeof item=="string"){url=item;if(!openURL[url]){openURL[url]={open:false,state:true}}else{openURL[url].state=true}openURL[url].open=false}else{url=item[pathField]||"";if(!openURL[url]){openURL[url]={open:false,state:true}}else{openURL[url].state=true}if(item.open!=null){if(item.open instanceof flower.Value){openURL[url].open=!!item.open.value;item.open.addListener(flower.Event.CHANGE,this.__onOpenItem,this)}else{openURL[url].open=!!item.open}}else{openURL[url].open=false}}depth=url.split("/").length;if(rootURLDepth==-1||rootURLDepth>depth){rootURLDepth=depth;rootURL=url;rootList=[]}if(depth==rootURLDepth){rootList.push(url)}if(!urlList[url]){urlList[url]={item:item,depth:depth,children:[]}}else{urlList[url].item=item}if(url.split("/").length>1){var parentURL=url.slice(0,url.length-(url.split("/")[url.split("/").length-1].length+1));if(!urlList[parentURL]){urlList[parentURL]={item:null,depth:null,children:[url]}}else{urlList[parentURL].children.push(url)}}}keys=Object.keys(openURL);for(var i=0,len=keys.length;i<len;i++){if(openURL[keys[i]].state==false){delete openURL[keys[i]]}}for(var i=0;i<rootList.length;i++){this.__readTreeShowItem(rootList[i],urlList,openURL,rootURLDepth,parentData)}}}},{key:"__onOpenItem",value:function __onOpenItem(e){this.__onTreeDataUpdate(null)}},{key:"__readTreeShowItem",value:function __readTreeShowItem(url,urlList,openURL,rootURLDepth,parentData){var info=urlList[url];var item=info.item;if(typeof item=="string"){}else{item.depth=info.depth-rootURLDepth;if(item.open!=null){if(item.open instanceof flower.Value){item.open.value=openURL[url].open}}else{item.open=new BooleanValue(openURL[url].open);item.open.addListener(flower.Event.CHANGE,this.__onOpenItem,this)}}parentData.push(item);if(openURL[url].open){var children=info.children;for(var i=0,len=children.length;i<len;i++){this.__readTreeShowItem(children[i],urlList,openURL,rootURLDepth,parentData)}}}},{key:"expand",value:function expand(url){var p=this.$Tree;var parentData=p[1];for(var i=0;i<parentData.length;i++){var item=parentData[i];if(item.path==url.slice(0,item.path.length)){item.open.value=true}}}},{key:"pathField",get:function get(){return this.$Tree[3]},set:function set(val){if(this.$Tree[3]==val){return}this.$Tree[3]=val;this.__onTreeDataUpdate(null)}}]);return Tree}(DataGroup);black.Tree=Tree;var Module=function(_flower$EventDispatch2){_inherits(Module,_flower$EventDispatch2);function Module(url){var beforeScript=arguments.length<=1||arguments[1]===undefined?"":arguments[1];_classCallCheck(this,Module);var _this40=_possibleConstructorReturn(this,Object.getPrototypeOf(Module).call(this));Module.instance=_this40;_this40.__url=url;_this40.__beforeScript=beforeScript;_this40.__direction=flower.Path.getPathDirection(url);_this40.__moduleKey="key"+Math.floor(Math.random()*1e8);_this40.__progress=flower.DataManager.getInstance().createData("Progress");return _this40}_createClass(Module,[{key:"load",value:function load(){var url=this.__url;this.__progress.tip=url;var loader=new flower.URLLoader(url);loader.load();loader.addListener(flower.Event.COMPLETE,this.__onLoadModuleComplete,this);loader.addListener(flower.Event.ERROR,this.__loadError,this)}},{key:"__onLoadModuleComplete",value:function __onLoadModuleComplete(e){var cfg=e.data;this.config=cfg;this.__name=cfg.name;flower.UIParser.addModule(cfg.name,this.__url,cfg.name);this.__list=[];var classes=cfg.classes;if(classes&&Object.keys(classes).length){for(var key in classes){var url=classes[key];if(url.slice(0,2)=="./"){url=this.__direction+url.slice(2,url.length)}flower.UIParser.setLocalUIURL(key,url,cfg.name)}}this.script="";this.script+=this.__beforeScript;this.script+="var module = $root."+cfg.name+" = $root."+cfg.name+"||{};\n";this.__beforeScript+="var module = $root."+cfg.name+";\n";this.__beforeScript+='var moduleKey = "key'+Math.floor(Math.random()*1e8)+'";\n';this.script+='module.path = "'+this.__direction+'";\n';this.script+='var moduleKey = "'+this.__moduleKey+'";\n';if(cfg.execute){this.__hasExecute=true;this.script+="$root."+cfg.name+"__executeModule = function() {"+cfg.execute+"}\n"}flower.UIParser.setModuleBeforeScript(cfg.name,this.__beforeScript);var scripts=cfg.scripts;if(scripts&&Object.keys(scripts).length){for(var i=0;i<scripts.length;i++){var url=scripts[i];if(url.slice(0,2)=="./"){url=this.__direction+url.slice(2,url.length)}this.__list.push({type:"script",url:url})}}var data=cfg.data;if(data&&Object.keys(data).length){for(var i=0;i<data.length;i++){var url=data[i];if(url.slice(0,2)=="./"){url=this.__direction+url.slice(2,url.length)}this.__list.push({type:"data",url:url})}}var components=cfg.components;if(components&&Object.keys(components).length){for(var i=0;i<components.length;i++){var url=components[i];if(url.slice(0,2)=="./"){url=this.__direction+url.slice(2,url.length)}var parser=new flower.UIParser(this.__beforeScript);parser.moduleName=cfg.name;this.__list.push({type:"ui",ui:parser,url:url})}}this.__index=0;this.__loadNext()}},{key:"__loadError",value:function __loadError(e){if(this.hasListener(flower.Event.ERROR)){this.dispatch(e)}else{flower.$error(e.data)}}},{key:"__loadNext",value:function __loadNext(e){var item;if(e&&this.__index!=0){item=this.__list[this.__index-1];if(item.type=="data"){if(e.data.script){var data=e.data;var url=e.data.script;if(url.slice(0,2)=="./"){url=flower.Path.getPathDirection(item.url)+url.slice(2,url.length)}var loader=new flower.URLLoader(url);loader.addListener(flower.Event.COMPLETE,function(ee){data.script=ee.data;flower.DataManager.getInstance().addDefine(data,this.__beforeScript);this.__loadNext()},this);loader.addListener(flower.Event.ERROR,this.__loadError,this);loader.load();return}else{flower.DataManager.getInstance().addDefine(e.data,this.__beforeScript)}}else if(item.type=="script"){this.script+=e.data+"\n\n\n";if(this.__index==this.__list.length||this.__list[this.__index].type!="script"){this.script+="flower.Module.$currentModule.data = module;";Module.$currentModule=this;eval(this.script);Module.$currentModule=null}}}if(this.__list.length==0){this.__index=this.__list.length=1}this.__progress.max=this.__list.length;this.__progress.current=this.__index;if(this.__index==this.__list.length){if(this.__hasExecute){$root[this.__name+"__executeModule"]()}this.dispatchWith(flower.Event.COMPLETE);return}item=this.__list[this.__index];if(item.type=="ui"){var ui=this.__list[this.__index].ui;var url=this.__list[this.__index].url;ui.addListener(flower.Event.COMPLETE,this.__loadNext,this);ui.addListener(flower.Event.ERROR,this.__loadError,this);ui.parseAsync(url)}else if(item.type=="data"||item.type=="script"){var loader=new flower.URLLoader(item.url);loader.addListener(flower.Event.COMPLETE,this.__loadNext,this);loader.addListener(flower.Event.ERROR,this.__loadError,this);loader.load()}this.__index++}},{key:"url",get:function get(){return this.__url}},{key:"progress",get:function get(){return this.__progress}},{key:"name",get:function get(){return this.__name}}]);return Module}(flower.EventDispatcher);black.Module=Module})();for(var key in black){flower[key]=black[key]}